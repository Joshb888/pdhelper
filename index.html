<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PD Paperwork Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #090b13; color: #fff; min-height: 100vh; }
    .sidebar {
      position: fixed; top: 0; left: 0; bottom: 0;
      width: 250px;
      background: #11152a;
      box-shadow: 2px 0 10px rgba(0,0,0,0.24);
      z-index: 60; padding-top: 32px;
      display: flex; flex-direction: column;
      align-items: center;
      overflow-y: auto;
    }
    .sidebar h4 { color: #cde0ff; margin: 10px 0 22px 0;}
    .sidebar button {
      width: 90%; margin: 8px 0; font-size:1.1em;
      color: #cde0ff;
      background: #1a2236;
      border: 1px solid #2342a4;
      border-radius: 7px;
      padding: 10px;
      text-align:left;
    }
    .sidebar button.active, .sidebar button:focus { background: #2f4ded !important; color: #fff;}
    .main-content {
      margin-left: 265px; padding: 36px 22px 22px 22px;
      min-height: 100vh;
      background: #101116;
    }
    .section { display: none; max-width: 600px; margin: 0 auto;}
    .section.active { display: block;}
    .form-label, label { color: #cbe3ff !important; }
    .form-control { background: #0f131e; color: #fff;}
    .btn-clear { margin-left: 15px;}
  </style>
</head>
<body>
  <aside class="sidebar">
    <h4>PD Paperwork Generator</h4>
    <button id="nav-Mugshot" onclick="navigateTo('MUGSHOT')" class="nav-btn">Mugshot</button>
    <button id="nav-Casefile" onclick="navigateTo('CASEFILE')" class="nav-btn">Casefile</button>
    <button id="nav-Suspect" onclick="navigateTo('SUSPECT')" class="nav-btn">Suspect</button>
  </aside>
  <main class="main-content">
    
    <!-- Mugshot Section -->
    <section id="MUGSHOT" class="section">
      <h2>Mugshot</h2>
      <form id="mugshotForm">
        <div class="mb-3"><label>Date:</label>
          <input type="date" class="form-control" id="mugshotDate" required>
        </div>
        <div class="mb-3"><label>Image URL:</label>
          <input type="url" class="form-control" id="mugshotUrl" placeholder="https://..." required>
        </div>
        <div class="mb-3">
          <button type="submit" class="btn btn-success">Generate</button>
          <button type="button" class="btn btn-warning btn-clear" id="clearMugshot">Clear</button>
        </div>
        <label>BBCode Output:</label>
        <textarea id="mugshotOutput" class="form-control" rows="5" readonly></textarea>
      </form>
    </section>

    <!-- Casefile Section -->
    <section id="CASEFILE" class="section">
      <h2>Casefile</h2>
      <form id="casefileForm">
        <div class="mb-3"><label>Date:</label>
          <input type="date" class="form-control" id="casefileDate" required>
        </div>
        <div class="mb-3"><label>Assigned Unit:</label>
          <input type="text" class="form-control" id="casefileUnit" required>
        </div>
        <div class="mb-3"><label>Narrative:</label>
          <textarea class="form-control" id="casefileNarrative" required></textarea>
        </div>
        <div class="mb-3">
          <button type="submit" class="btn btn-success">Generate</button>
          <button type="button" class="btn btn-warning btn-clear" id="clearCasefile">Clear</button>
        </div>
        <label>BBCode Output:</label>
        <textarea id="casefileOutput" class="form-control" rows="5" readonly></textarea>
      </form>
    </section>

    <!-- Suspect Section -->
    <section id="SUSPECT" class="section">
      <h2>Suspect Info</h2>
      <form id="suspectForm">
        <div class="mb-3"><label>Name:</label>
          <input type="text" class="form-control" id="suspectName" required>
        </div>
        <div class="mb-3"><label>Extra Details:</label>
          <textarea class="form-control" id="suspectExtra"></textarea>
        </div>
        <div class="mb-3">
          <button type="submit" class="btn btn-success">Generate</button>
          <button type="button" class="btn btn-warning btn-clear" id="clearSuspect">Clear</button>
        </div>
        <label>BBCode Output:</label>
        <textarea id="suspectOutput" class="form-control" rows="5" readonly></textarea>
      </form>
    </section>
  </main>
  <script>
    // ----- ROUTER -----
    const SECTIONS = ['MUGSHOT','CASEFILE','SUSPECT'];
    function showSection(id) {
      SECTIONS.forEach(section => {
        document.getElementById(section).classList.remove('active');
        document.getElementById('nav-'+capitalize(section)).classList.remove('active');
      });
      document.getElementById(id).classList.add('active');
      document.getElementById('nav-'+capitalize(id)).classList.add('active');
    }
    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
    }
    // URL parse: "/Mugshot" => "MUGSHOT"
    function sectionFromPath(path) {
      let s = path.replace(/^\//, '').toUpperCase();
      if(SECTIONS.includes(s)) return s;
      return SECTIONS[0];
    }
    // Used by sidebar buttons
    function navigateTo(id) {
      showSection(id);
      history.pushState({section: id}, '', '/' + capitalize(id));
    }
    // On back/forward navigation
    window.addEventListener('popstate', function(ev) {
      let section = ev.state && ev.state.section || sectionFromPath(location.pathname);
      showSection(section);
    });
    // On load, show correct section from path or fallback
    document.addEventListener('DOMContentLoaded', function() {
      let initial = sectionFromPath(location.pathname);
      showSection(initial);
      history.replaceState({section: initial}, '', '/' + capitalize(initial));
    });

    // ----- MUGSHOT FORM -----
    document.getElementById('mugshotForm').addEventListener('submit', function(e) {
      e.preventDefault();
      let d = document.getElementById('mugshotDate').value;
      let url = document.getElementById('mugshotUrl').value.trim();
      let out = `[spoiler=${d}]
[img]${url}[/img]
[/spoiler]`;
      document.getElementById('mugshotOutput').value = out;
      document.getElementById('mugshotOutput').select();
    });
    document.getElementById('clearMugshot').onclick = function() {
      document.getElementById('mugshotDate').value = '';
      document.getElementById('mugshotUrl').value = '';
      document.getElementById('mugshotOutput').value = '';
    };

    // ----- CASEFILE FORM -----
    document.getElementById('casefileForm').addEventListener('submit', function(e) {
      e.preventDefault();
      let date = document.getElementById('casefileDate').value;
      let unit = document.getElementById('casefileUnit').value.trim();
      let n = document.getElementById('casefileNarrative').value.trim();
      let out = `[casefile]
Date: ${date}
Unit: ${unit}
Narrative: ${n}
[/casefile]`;
      document.getElementById('casefileOutput').value = out;
      document.getElementById('casefileOutput').select();
    });
    document.getElementById('clearCasefile').onclick = function() {
      document.getElementById('casefileDate').value = '';
      document.getElementById('casefileUnit').value = '';
      document.getElementById('casefileNarrative').value = '';
      document.getElementById('casefileOutput').value = '';
    };

    // ----- SUSPECT FORM -----
    document.getElementById('suspectForm').addEventListener('submit', function(e) {
      e.preventDefault();
      let name = document.getElementById('suspectName').value.trim();
      let extra = document.getElementById('suspectExtra').value.trim();
      let out = `[suspect]
Name: ${name}
Details: ${extra}
[/suspect]`;
      document.getElementById('suspectOutput').value = out;
      document.getElementById('suspectOutput').select();
    });
    document.getElementById('clearSuspect').onclick = function() {
      document.getElementById('suspectName').value = '';
      document.getElementById('suspectExtra').value = '';
      document.getElementById('suspectOutput').value = '';
    };
  </script>
</body>
</html>
