<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PD Paperwork Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap 5 for responsive accordion and utility classes -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    html, body {
      background: #090b13;
      min-height: 100vh;
      color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    .sidebar {
      position: fixed;
      top: 0; left: 0; bottom: 0;
      width: 280px;
      background: #11152a;
      box-shadow: 2px 0 10px rgba(0,0,0,0.24);
      z-index: 1060;
      padding-top: 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-y: auto;
    }
    .sidebar img {
      width: 180px;
      margin-bottom: 35px;
      border-radius: 7px;
      border: 2px solid #182060;
      background: #11152a;
    }
    .sidebar .accordion-item, .sidebar .accordion-button {
      background: transparent;
      color: #c9d6ff;
    }
    .sidebar .accordion-button:not(.collapsed) {
      background: #182060;
      color: #fff;
    }
    .sidebar .accordion-body {
      padding: 0 8px 6px 8px;
    }
    .sidebar .btn {
      background: #1d253d;
      color: #c9d6ff;
      margin-bottom: 5px;
      border: none;
      border-radius: 4px;
      width: 100%;
      text-align: left;
    }
    .sidebar .btn-success {
      background: #2f4ded !important;
      color: #fff !important;
    }
    .sidebar .btn:hover, .sidebar .btn:focus {
      background: #2342a4;
      color: #fff;
    }
    .main-content {
      margin-left: 295px;
      padding: 38px 25px 25px 25px;
      background: #101116;
      min-height: 100vh;
    }
    .main-content .header-title {
      color: #c9e0ff;
      text-shadow: 1px 1px 6px #08163a;
      font-size: 2rem;
      margin-bottom: 38px;
      text-align: center;
      letter-spacing: 0.4px;
    }
.sheet-viewer-block {
  margin: 30px auto;

  max-width: 900px;
  border-radius: 12px;
  overflow: hidden;
  background: #181c25;
  box-shadow: 0 4px 24px #0005;
  border: 1.5px solid #3046a4;
}
.search-sheet-box {
  background: #1a1e2b;
  border: 2px solid #3050a0;
  padding: 24px;
  margin: 40px auto;
  max-width: 900px;
  border-radius: 10px;
  box-shadow: 0 6px 26px #000a;
  color: #e0ecff;
}
.search-sheet-box2 {
  background: #1a1e2b;
  border: 2px solid #3050a0;
  padding: 24px;
  margin: 40px auto;
  max-width: 3300px;
  border-radius: 10px;
  box-shadow: 0 6px 26px #000a;
  color: #e0ecff;
}

.search-sheet-box2 h3 {
  text-align: center;
  margin-bottom: 30px;
  color: #cde2ff;
}
.search-sheet-box h3 {
  text-align: center;
  margin-bottom: 16px;
  color: #cde2ff;
}

.search-sheet-box input[type="text"] {
  width: 100%;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid #444e80;
  background: #0f131e;
  color: #fff;
  font-size: 1.06rem;
  margin-bottom: 12px;
}

.search-sheet-box2 input[type="text"] {
  width: 100%;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid #444e80;
  background: #0f131e;
  color: #fff;
  font-size: 1.06rem;
  margin-bottom: 12px;
}
.search-sheet-box button {
  display: inline-block;
  padding: 10px 18px;
  font-size: 1rem;
  background: #2f53dc;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.search-sheet-box2 button {
  display: inline-block;
  padding: 10px 18px;
  font-size: 1rem;
  background: #2f53dc;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
.results-box {
  margin-top: 24px;
  background: #101420;
  border: 1px solid #2f3c60;
  padding: 14px;
  border-radius: 7px;
  overflow-x: auto;
}

.results-box table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.95rem;
}

.results-box th, .results-box td {
  padding: 10px;
  border: 1px solid #263556;
  text-align: left;
  color: #dde8ff;
}

.results-box th {
  background: #253155;
  font-weight: 700;
}

.info-dashboard {
  background: #091f62;
  max-width: 500px;
  margin: 30px auto;
  padding: 30px 0;
  border: 2px solid #222;
  font-family: Arial, Helvetica, sans-serif;
  border-radius: 4px;
}
.info-dashboard h1 {
  text-align: center;
  font-weight: bold;
  font-size: 2rem;
  margin-bottom: 15px;
  letter-spacing: 1px;
}
.section {
  margin: 20px 0 0 0;
  padding-bottom: 4px;
}
.section-header {
  background: #111;
  color: #fff;
  padding: 6px 10px;
  font-size: 1.05rem;
  font-weight: bold;
  margin-bottom: 3px;
  border-radius: 2px;
  letter-spacing: 1px;
}
.info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 3px 15px;
  font-size: 1rem;
  border-bottom: 1px solid #091f62;
  background: #091f62;
}
.info-row.bold {
  font-weight: bold;
  background: #091f62;
}
.info-row .number {
  font-weight: bold;
  margin-left: 4px;
}
.dashboard-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 40px;
  justify-content: center;
  margin-top: 30px;
}

.desk-links-panel {
  background: #101420;
  border: 1.5px solid #2d426f;
  box-shadow: 0 4px 24px #0005;
  border-radius: 8px;
  max-width: 500px;
  width: 100%;
  padding: 24px;
  color: #cde0ff;
}

.desk-links-panel h2 {
  font-size: 1.4rem;
  text-align: center;
  margin-bottom: 20px;
  color: #cbe3ff;
  text-shadow: 0 0 5px #3050a0;
}

.desk-section {
  margin-bottom: 26px;
}

.desk-title {
  background: #182040;
  color: #fff;
  font-weight: bold;
  padding: 7px 12px;
  font-size: 1.02rem;
  margin-bottom: 6px;
  border-radius: 4px;
  letter-spacing: 0.6px;
  text-shadow: 0 0 6px #0009;
}

.desk-section a {
  display: block;
  padding: 8px 12px;
  background: #0f131d;
  color: #8cbfff;
  text-decoration: none;
  margin-bottom: 4px;
  border-left: 3px solid #3050a0;
  border-radius: 4px;
  transition: background 0.2s, color 0.2s;
}

.desk-section a:hover {
  background: #1c2947;
  color: #fff;
  border-left-color: #4983ff;
}
.signature-box {
  margin: 20px 16px;
  padding: 16px;
  background: #1a1e3a;
  border: 1px solid #2b3c6c;
  border-radius: 8px;
  box-shadow: 0 0 10px #0004;
  color: #c9d6ff;
  font-size: 0.95rem;
}

.signature-box .signature-title {
  font-size: 1.08rem;
  margin-bottom: 8px;
  color: #cfe0ff;
  text-align: center;
}

.signature-box .signature-sub {
  display: block;
  text-align: center;
  margin-bottom: 12px;
  font-size: 0.85rem;
  color: #8ea4cc;
}

.signature-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.signature-entry {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #101322;
  padding: 6px 10px;
  border-radius: 4px;
  border: 1px solid #2a3860;
}

.signature-entry span {
  flex: 1;
  font-size: 0.9rem;
  color: #f2f4ff;
  padding-right: 10px;
}

.signature-entry button {
  padding: 4px 10px;
  background: #2e5eff;
  border: none;
  color: white;
  font-size: 0.85rem;
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.2s;
}
.signature-entry button:hover {
  background: #3e75ff;
}
.signature-entry button:active {
  transform: scale(0.95);
}


    .myHideableSection { display: none; }
    .myHideableSection.active { display: block; }
    .sidebar::-webkit-scrollbar { width: 8px; }
    .sidebar::-webkit-scrollbar-thumb { background: #222c47; border-radius: 8px; }
  </style>


</head>
<body>
  <!-- Sidebar with Logo and Navigation Accordion -->
  <aside class="sidebar">
    <img src="https://i.imgur.com/UYd15I0.png" alt="PD Logo">
    <div class="accordion w-100" id="tocAccordion">
<div class="accordion-item">
  <h2 class="accordion-header" id="headingDatabase">
    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDatabase" aria-expanded="true" aria-controls="collapseDatabase">
      Emails
    </button>
  </h2>
  <div id="collapseDatabase" class="accordion-collapse collapse show" aria-labelledby="headingDatabase" data-bs-parent="#tocAccordion">
    <div class="accordion-body">
      <!-- Email -->
      <div class="mb-3">
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-secondary" onclick="showSection('lspdMCDGen', this)">[MCD] Email</button>
          <button class="btn btn-secondary" onclick="showSection('lspdDetectiveGen', this)">[DB] Email</button>
          <button class="btn btn-secondary" onclick="showSection('lspdK9Gen', this)">[K9] Email</button>
          <button class="btn btn-secondary" onclick="showSection('workLogGen', this)">[PD] Email</button>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="accordion-item">
  <h2 class="accordion-header" id="headingDatabase">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseATC" aria-expanded="false" aria-controls="collapseATC">
            Major Crimes
          </button>
  </h2>
        <div id="collapseATC" class="accordion-collapse collapse" aria-labelledby="headingATC" data-bs-parent="#tocAccordion">
    <div class="accordion-body">

 
      <!-- Shift Log -->
      <div class="mb-3">
        <h6 class="text-light text-uppercase mb-2" style="font-size: 0.9rem;">📄 Casefile</h6>
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-secondary" onclick="showSection('CASEFILE', this)">Casefile Creation</button>
          <button class="btn btn-secondary" onclick="showSection('SUSPECT', this)">Add Suspect</button>
          <button class="btn btn-secondary" onclick="showSection('VICTIM', this)">Add Victim</button>
          <button class="btn btn-secondary" onclick="showSection('EVIDENCE', this)">Add Evidence</button>
          <button class="btn btn-secondary" onclick="showSection('OPERATION', this)">Add Operation</button>
          <button class="btn btn-secondary" onclick="showSection('InterviewGen', this)">Add Interigation</button>
          <button class="btn btn-secondary" onclick="showSection('UPDATE', this)">Casefile Update</button>
        </div>
      </div>

      <!-- Operator Logs -->
      <div class="mb-3">
        <h6 class="text-light text-uppercase mb-2" style="font-size: 0.9rem;">📋 Dossier</h6>
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-secondary" onclick="showSection('DOSSIER', this)">Add Dossier</button>
          <button class="btn btn-secondary" onclick="showSection('MUGSHOT', this)">Add Mugshot</button>
          <button class="btn btn-secondary" onclick="showSection('VEHICLE', this)">Add Vehicle</button>
          <button class="btn btn-secondary" onclick="showSection('AFFIL', this)">Add Affiliate</button>
          <button class="btn btn-secondary" onclick="showSection('CHARGE', this)">Add Charge</button>
          <button class="btn btn-secondary" onclick="showSection('LOG', this)">Dossier Log</button>
        </div>
      </div>


    </div>
  </div>
</div>
<div class="accordion-item">
        <h2 class="accordion-header" id="headingFieldTraining">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFieldTraining" aria-expanded="false" aria-controls="collapseFieldTraining">
            Database
          </button>
        </h2>
        <div id="collapseFieldTraining" class="accordion-collapse collapse" aria-labelledby="headingFieldTraining" data-bs-parent="#tocAccordion">
          <div class="accordion-body d-flex flex-wrap gap-2">

      <div class="mb-3">
        <div class="d-flex flex-wrap gap-2">
               <button class="btn btn-secondary" onclick="showSection('admissionGuilt', this)">Admission Of Guilt</button>
          <button class="btn btn-secondary" onclick="showSection('traceLog', this)">Trace Log</button>
          <button class="btn btn-secondary" onclick="showSection('radioFrequencyLog', this)">Radio Log</button>
          <button class="btn btn-secondary" onclick="showSection('narcoticsConfiscation', this)">Confiscation Log</button>
          <button class="btn btn-secondary" onclick="showSection('monetaryRecovery', this)">Monetary Recovery Log</button>
        </div>
      </div>

    </div>
  </div>
</div>

<div class="accordion-item">
        <h2 class="accordion-header" id="headingK9">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseK9" aria-expanded="false" aria-controls="collapseK9">
            Training Documents
          </button>
        </h2>
        <div id="collapseK9" class="accordion-collapse collapse" aria-labelledby="headingK9" data-bs-parent="#tocAccordion">
          <div class="accordion-body d-flex flex-wrap gap-2">

 
      <!-- Training Division -->
      <div class="mb-3">
        <h6 class="text-light text-uppercase mb-2" style="font-size: 0.9rem;">Training Division</h6>
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-secondary" onclick="showSection('VehPass', this)">Vehicle (Pass)</button>
          <button class="btn btn-secondary" onclick="showSection('VehPract', this)">Vehicle (Practical)</button>
          <button class="btn btn-secondary" onclick="showSection('VehFail', this)">Vehicle (Fail)</button>
          <button class="btn btn-secondary" onclick="showSection('WPass', this)">Weapon (Pass)</button>
          <button class="btn btn-secondary" onclick="showSection('WFail', this)">Weapon (Fail)</button>
        </div>
      </div>

      <!-- Field Training Division -->
      <div class="mb-3">
        <h6 class="text-light text-uppercase mb-2" style="font-size: 0.9rem;">Field Training Division</h6>
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-secondary" onclick="showSection('FTS', this)">FTS</button>
          <button class="btn btn-secondary" onclick="showSection('FPS', this)">FPS</button>
        </div>
      </div>


    </div>
  </div>
</div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="headingIFC">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIFC" aria-expanded="false" aria-controls="collapseIFC">
            K9
          </button>
        </h2>
        <div id="collapseIFC" class="accordion-collapse collapse" aria-labelledby="headingIFC" data-bs-parent="#tocAccordion">
          <div class="accordion-body d-flex flex-wrap gap-2">
      <!-- Casefile -->
      <div class="mb-3">
        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-secondary" onclick="showSection('K9', this)">K9</button>
        </div>
      </div>

    </div>
  </div>
</div>


  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <div class="header-title">PD Paperwork Generator</div>



<div id="lspdDetectiveGen" class="container mt-3 myHideableSection" style="max-width: 800px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #091f62, #003399); color: white;">
    <div class="card-header text-center">
      <h4>LSPD Detective Bureau Letter Generator</h4>
    </div>
    <div class="card-body">
      <form id="lspdDetectiveForm" autocomplete="off" novalidate>
        <!-- Letter Body -->
        <div class="mb-3 row align-items-center">
          <label for="letterBody" class="col-sm-4 col-form-label fw-bold text-end">Letter Body:</label>
          <div class="col-sm-8">
            <textarea id="letterBody" class="form-control" rows="7" required placeholder="Enter the body of your letter here..."></textarea>
          </div>
        </div>
           <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="lspdDetectiveCopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="lspdDetectiveBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="lspdDetectiveBBOutput" class="form-control" rows="20" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Universal signature storage for LSPD forms

// Save signature when form submits
document.getElementById('lspdDetectiveForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const successMsg = document.getElementById('lspdDetectiveCopySuccess');
  successMsg.textContent = '';


  if (!this.checkValidity()) {
    this.reportValidity();
    return;
  }

  const letterBody = document.getElementById('letterBody').value.trim();

  const bbcode = `[img]https://i.imgur.com/88vzzHs.jpg[/img]
[divbox=white]
[dblogo=150][/dblogo][aligntable=right,0,0,0,0,0,0][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=120]Detective Bureau[/size]
[size=95]"TO PROTECT AND SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none]

${letterBody}

[/list][hr][/hr][list=none]

Sincerely,
[fimg=150,40]https://imgur.com/p2ksyW2.png[/fimg]
Mick Wegman, Police Detective I
Detective, Major Crimes Unit
Los Santos Police Department[/list][/divbox]
[img]https://i.imgur.com/88vzzHs.jpg[/img]`;

  const outputArea = document.getElementById('lspdDetectiveBBOutput');
  outputArea.value = bbcode.trim();
  outputArea.focus();
  outputArea.select();

  try {
    navigator.clipboard.writeText(bbcode).then(() => {
      successMsg.textContent = 'Copied to clipboard!';
    }, () => {
      successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
    });
  } catch {
    successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
  }
});
</script>



<div id="lspdK9Gen" class="container mt-3 myHideableSection" style="max-width: 800px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #091f62, #003399); color: white;">
    <div class="card-header text-center">
      <h4>LSPD K9 Letter Generator</h4>
    </div>
    <div class="card-body">
      <form id="lspdK9Form" autocomplete="off" novalidate>
        <!-- Letter Body -->
        <div class="mb-3 row align-items-center">
          <label for="letterBody2" class="col-sm-4 col-form-label fw-bold text-end">Letter Body:</label>
          <div class="col-sm-8">
            <textarea id="letterBody2" class="form-control" rows="7" required placeholder="Enter the body of your letter here..."></textarea>
          </div>
        </div>
           <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="lspdK9CopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="lspdK9BBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="lspdK9BBOutput" class="form-control" rows="20" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Universal signature storage for LSPD forms

// Save signature when form submits
document.getElementById('lspdK9Form').addEventListener('submit', function(e) {
  e.preventDefault();
  const successMsg = document.getElementById('lspdK9CopySuccess');
  successMsg.textContent = '';


  if (!this.checkValidity()) {
    this.reportValidity();
    return;
  }

  const letterBody = document.getElementById('letterBody2').value.trim();

  const bbcode = `[img]https://i.imgur.com/88vzzHs.jpg[/img][divbox=white]
[fimg=160,160]https://i.imgur.com/sllG7ls.png[/fimg][aligntable=right,0,0,0,0,0,0][right][font=Arial][b] 
[size=150]Los Santos Police Department[/size][/b]
[size=115]Metropolitan Divison K-9 Platoon[/size]
[size=95]"TO PROTECT AND SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none]

${letterBody}

[/list][hr][/hr][list=none]

Regards,
[img]https://imgur.com/p2ksyW2.png[/img]
[b]Police Detective I Mick Wegman[/b]
Officer In Charge, K-9 Platoon
Metropolitan Division
Los Santos Police Department[/list][/divbox]
[img]https://i.imgur.com/88vzzHs.jpg[/img]`;

  const outputArea = document.getElementById('lspdK9BBOutput');
  outputArea.value = bbcode.trim();
  outputArea.focus();
  outputArea.select();

  try {
    navigator.clipboard.writeText(bbcode).then(() => {
      successMsg.textContent = 'Copied to clipboard!';
    }, () => {
      successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
    });
  } catch {
    successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
  }
});
</script>



<div id="lspdMCDGen" class="container mt-3 myHideableSection" style="max-width: 800px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #091f62, #003399); color: white;">
    <div class="card-header text-center">
      <h4>LSPD Major Crimes Letter Generator</h4>
    </div>
    <div class="card-body">
      <form id="lspdMCDForm" autocomplete="off" novalidate>
        <!-- Letter Body -->
        <div class="mb-3 row align-items-center">
          <label for="letterBody3" class="col-sm-4 col-form-label fw-bold text-end">Letter Body:</label>
          <div class="col-sm-8">
            <textarea id="letterBody3" class="form-control" rows="7" required placeholder="Enter the body of your letter here..."></textarea>
          </div>
        </div>
           <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="lspdK9CopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="lspdMCDBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="lspdMCDBBOutput" class="form-control" rows="20" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Universal signature storage for LSPD forms

// Save signature when form submits
document.getElementById('lspdMCDForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const successMsg = document.getElementById('lspdMCDCopySuccess');
  successMsg.textContent = '';


  if (!this.checkValidity()) {
    this.reportValidity();
    return;
  }

  const letterBody = document.getElementById('letterBody3').value.trim();

  const bbcode = `[lspdfooter][/lspdfooter]
[divbox=white]
[mcdlogo=150][aligntable=right,0,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none]

${letterBody}

[/list][hr][/hr][list=none]

Sincerely,
[fimg=300,70]https://imgur.com/p2ksyW2.png[/fimg]
[b]Police Detective I Mick Wegman[/b]
Major Crimes Unit, Detective Bureau
Los Santos Police Department[/list][/divbox]
[img]https://i.imgur.com/88vzzHs.jpg[/img]`;

  const outputArea = document.getElementById('lspdMCDBBOutput');
  outputArea.value = bbcode.trim();
  outputArea.focus();
  outputArea.select();

  try {
    navigator.clipboard.writeText(bbcode).then(() => {
      successMsg.textContent = 'Copied to clipboard!';
    }, () => {
      successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
    });
  } catch {
    successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
  }
});
</script>


<div id="InterviewGen" class="container mt-3 myHideableSection" style="max-width: 900px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #091f62, #003399); color: white;">
    <div class="card-header text-center">
      <h4>[DB] Interview Generator</h4>
    </div>
    <div class="card-body">
      <form id="atcShiftLogForm2" autocomplete="off" novalidate>
        <!-- Operator Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtatcname" class="col-sm-4 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-8">
            <input type="text" id="txtatcname" class="form-control" required />
          </div>
        </div>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="txtatcdate" class="col-sm-4 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-8">
            <input type="date" id="txtatcdate" class="form-control" required />
          </div>
        </div>
        <!-- Detectives -->
        <div class="mb-3 row align-items-center">
          <label for="txtatctower" class="col-sm-4 col-form-label fw-bold text-end">Detective's:</label>
          <div class="col-sm-8">
            <input type="text" id="txtatctower" class="form-control" required />
          </div>
        </div>
        <!-- Shift Start/End -->
        <div class="mb-3 row align-items-center">
          <label for="txtatcstart" class="col-sm-4 col-form-label fw-bold text-end">Your Name:</label>
          <div class="col-sm-8">
            <input type="text" id="txtatcstart" class="form-control" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtatcran" class="col-sm-4 col-form-label fw-bold text-end">Rank:</label>
          <div class="col-sm-8">
            <input type="text" id="txtatcend" class="form-control" required />
          </div>
        </div>

        <!-- Inter Entries -->
        <fieldset class="mb-3">
          <legend class="fw-bold">Transcript</legend>
          <div class="row mb-2 align-items-center">
            <label class="col-md-2 col-form-label fw-bold text-end">Transcript:</label>
            <div class="col-md-10 d-flex gap-2">
              <select id="time" class="form-select form-select-sm">
                <option value="[color=#4000BF][b]DI:[/b][/color]">Detective</option>
                <option value="[color=#BF0000][b]SI:[/b][/color]">Suspect</option>
              </select>              
<input type="text" id="atctext" placeholder="Text" class="form-control" />
              <button type="button" id="addButton" class="btn btn-primary">Add</button>
              <button type="button" id="removeButton" class="btn btn-danger">Remove Last</button>
            </div>
          </div>
          <ul id="itemList" class="list-group list-group-flush" style="max-height: 120px; overflow-y: auto;"></ul>
        </fieldset>
        <!-- Generate -->
        <div class="text-center">
          <button type="button" id="btnCopy7" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="copyExpense2ReportSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayExpense2ReportBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayExpense2ReportBB" class="form-control" rows="30" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
function formatDateDDMMMYYYY(dateStr) {
  if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
  const [year, month, day] = dateStr.split('-');
  return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
}

// ATC entry add/remove
document.getElementById('addButton').addEventListener('click', () => {
  const time = document.getElementById('time').value.trim();
  const atc = document.getElementById('atctext').value.trim();

  if (!time || !atc) {
    alert('Please fill in all ATC fields.');
    return;
  }

  const li = document.createElement('li');
  li.className = 'list-group-item bg-light text-dark';
  li.textContent = `${time} : ${atc}`;
  document.getElementById('itemList').appendChild(li);

  // Clear inputs
  document.getElementById('time').value = '';
  document.getElementById('atctext').value = '';
});

document.getElementById('removeButton').addEventListener('click', () => {
  const list = document.getElementById('itemList');
  if (list.lastChild) list.removeChild(list.lastChild);
});



// Generate and copy BBCode
document.getElementById('btnCopy7').addEventListener('click', () => {
  const atcname = document.getElementById('txtatcname').value.trim();
  const rawDate = document.getElementById('txtatcdate').value.trim();
  const atcdate = formatDateDDMMMYYYY(rawDate);
  const atctower = document.getElementById('txtatctower').value.trim();
  const atcstart = document.getElementById('txtatcstart').value.trim();
  const atcend = document.getElementById('txtatcend').value.trim();


  if (!atcname || !rawDate || !atctower || !atcstart || !atcend) {
    alert('Please fill in all required fields.');
    return;
  }

  // Collect ATC entries
  const itemList = document.getElementById('itemList');
  let itemListString = '';
  itemList.querySelectorAll('li').forEach(li => {
    itemListString += li.textContent + '\n';
  });


  const expense2Template = `[spoiler=Interrogation - ${atcname}][list=none]
[color=#4000BF][b]DETECTIVE NAME (DETECTIVE INITIALS):[/b][/color] ${atctower}
[color=#BF0000][b]SUSPECT NAME(SUSPECT INITIALS):[/b][/color] ${atcname}
${itemListString}
[hr][/hr]
${atcdate}
[font=cursive]${atcstart}[/font]
${atcend}
Los Santos Police Department
[/spoiler]`;

  const outputArea = document.getElementById('displayExpense2ReportBB');
  outputArea.value = expense2Template.trim();
  outputArea.focus();
  outputArea.select();

  try {
    navigator.clipboard.writeText(expense2Template).then(() => {
      document.getElementById('copyExpense2ReportSuccess').textContent = 'Copied to clipboard!';
    }, () => {
      document.getElementById('copyExpense2ReportSuccess').textContent = 'Failed to copy automatically. Please copy manually.';
    });
  } catch {
    document.getElementById('copyExpense2ReportSuccess').textContent = 'Clipboard API not supported. Please copy manually.';
  }
});
</script>





<!-- Dossier -->
    <div id="DOSSIER" class="container mt-3 myHideableSection">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header border-0 text-center">
      <h3 class="mb-0">Dossier</h3>
    </div>
    <div class="card-body">
      <form id="dossierForm" autocomplete="off">
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Name:</div>
          <div class="col-md-9">
            <input type="text" id="txtDName" class="form-control" required />
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Mugshot (URL):</div>
          <div class="col-md-9">
            <input type="url" id="txtDMugshot" class="form-control" />
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Full Name:</div>
          <div class="col-md-9">
            <input type="text" id="txtDFName" class="form-control" />
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Phone:</div>
          <div class="col-md-9">
            <input type="text" id="txtDPhone" class="form-control" />
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Ethnicity:</div>
          <div class="col-md-9">
            <input type="text" id="txtDEth" class="form-control" />
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Main Criminal Activity:</div>
          <div class="col-md-9">
            <input type="text" id="txtDMCA" class="form-control" />
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3 col-form-label text-end fw-bold">Short Summary:</div>
          <div class="col-md-9">
            <input type="text" id="txtDSum" class="form-control" />
          </div>
        </div>

        <hr class="bg-light" />

        <!-- Criteria Section -->
        <div class="mb-3">
          <label class="fw-bold">Criminal Activity Criteria:</label>
          <div class="row g-2">
            <div class="col-md-6">
              <label class="form-label small">Arrested within a group:</label>
              <select id="AO1" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Admitted association:</label>
              <select id="AO2" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Documented association:</label>
              <select id="AO3" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Pattern of activity:</label>
              <select id="AO4" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Repeat offender:</label>
              <select id="AO5" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Active radio frequency:</label>
              <select id="AO6" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Identified by informant:</label>
              <select id="AO7" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Prolific repeat offender:</label>
              <select id="AO8" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Sex offender:</label>
              <select id="AO9" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Terroristic threats:</label>
              <select id="AO10" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Known terrorist:</label>
              <select id="AO11" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
          </div>
        </div>

        <div class="mt-4 text-center">
          <button type="button" id="btnCopy" class="btn btn-success px-4">
            Submit and Copy to Clipboard
          </button>
          <div id="copyDossierSuccess" class="mt-2 small"></div>
        </div>
        <div class="mt-3">
          <label for="displayDossierBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayDossierBB" class="form-control" rows="10" readonly>BBCode will appear here</textarea>
        </div>
      </form>
    </div>
  </div>
    </div>

<!-- Modern JavaScript (no jQuery needed) -->
<script>
function createDossierReport() {
  // Grab values
  const Name = document.getElementById('txtDName').value.trim();
  const Mugshot = document.getElementById('txtDMugshot').value.trim();
  const FullName = document.getElementById('txtDFName').value.trim();
  const Phone = document.getElementById('txtDPhone').value.trim();
  const Eth = document.getElementById('txtDEth').value.trim();
  const CriminalA = document.getElementById('txtDMCA').value.trim();
  const Summary = document.getElementById('txtDSum').value.trim();

  const encodedName2 = encodeURIComponent(Name.replace(/ /g, "+"));

  // Criteria
  const AO = [];
  for(let i=1; i<=11; i++) {
    AO[i] = document.getElementById('AO'+i).value;
  }

  // BBCode template
  const DossierTemplate = `[img]https://i.imgur.com/jWK4EiH.png[/img]
[divbox=white][center][size=150][url=search.php?keywords=${encodedName2}][b]${Name}[/b][/url][/size]
[i]Previous Names[/i]:
[url=search.php?keywords=Jack+Doe][b]Jack Doe[/b][/url][/center][/divbox]
[lspdsubtitle]1. IDENTIFICATION[/lspdsubtitle]
[divbox=white][clearfix]

[aligntable=right,260,5,5,0,0,0]
‏‏‎‎‏‏‎‎‏‏‎ ‎‏‏‎ ‎‎‏‏‎ 
[center][fimg=150,150]${Mugshot}[/fimg][/center]
[center][highlight=lightblue]‎ [b]Personal Information‎[/b]‎ [/highlight][/center]
[list=none]
[*][size=85][b]Full name[/b][/size] ‎‏‏‎${FullName}
[*][size=85][b]Phone no.[/b][/size] ‎‏‏‎${Phone}
[*][size=85][b]Ethnicity[/b][/size] ${Eth}
[/list]
[center][highlight=lightblue]‏‏‎‏‏‎ [b]‏‏‎Activity[/b]‎ [/highlight][/center]
[center]${CriminalA}[/center]
[hr]

[/aligntable]

[list=none]

[size=90][b]Surveillance[/b][/size]

[list=none]
[spoiler=Clothing Overview]

[spoiler=DD/MON/YYYY]
[img]IMAGE[/img]
[/spoiler]

[/spoiler]
[/list]

[size=90][b]Owned or Used Vehicles[/b][/size]

[list=none]
[spoiler=Vehicles Overview]

[spoiler=OWNER, MODEL, COLOR, PLATE]
[b]VIN:[/b] VINNUMBER
[img]IMAGE[/img]
[/spoiler]

[/spoiler]

[/list]

[size=90][b]Owned or Used Properties[/b][/size]

[list=none]

[spoiler=Properties Overview]

[spoiler=OWNER, ADDRESS]
[img]IMAGE[/img]
[img]GPS[/img]
[/spoiler]

[/spoiler]

[/list]

[size=90][b]Known Affiliates[/b][/size]

[list=none]

[spoiler=Affiliates List]
[List]
[*][url=search.php?keywords=FNAME+LNAME][b]Jack Doe[/b] [/url]

[/spoiler]

[/list]

[/list]

[/clearfix][/divbox]
[lspdsubtitle]2. CRIMINAL ACTIVITY[/lspdsubtitle]
[divbox=white]
[list=none]

[size=90][b]Criterion for criminal activity[/b][/size]

[spoil]
[${AO[1]}] [u]A[/u] - Suspect has been arrested within a group with others
[${AO[2]}] [u]B[/u] - Suspect has admitted to being associated with other individuals
[${AO[3]}] [u]C[/u] - Suspect has been documented associating with other individuals
[${AO[4]}] [u]D[/u] - Suspect has been documented displaying a pattern of activity with others
[${AO[5]}] [u]E[/u] - Suspect has been documented committing the same crime multiple times
[${AO[6]}] [u]F[/u] - Suspect has been documented by law enforcement on an active radio frequency
[${AO[7]}] [u]G[/u] - Suspect has been identified as a member of a group by a reliable confidential informant
[${AO[8]}] [u]H[/u] - Suspect is a Prolific Repeat Offender.
[${AO[9]}] [u]I[/u] - Suspect is a Sex Offender.
[${AO[10]}] [u]J[/u] - Suspect has been documented making terroristic threats or affiliating with known terrorists.
[${AO[11]}] [u]K[/u] - Suspect is a Known Terrorist.
[spoiler=Short Summary] ${Summary} [/spoiler]
[/spoil]

[hr]

[size=90][b]Incidents of Major Criminal Activity[/b][/size]

[spoil=Arrest or Incident Reports][list]
[*][url=LINK HERE]DD/MMM/YYYY - Arrest/Incident report[/url]
[/list]

[/list]
[/divbox][lspdfooter][/lspdfooter]`;

  // Output to textarea and copy
  const output = document.getElementById("displayDossierBB");
  output.value = DossierTemplate.trim();
  output.select();
  document.execCommand('copy');
  document.getElementById('copyDossierSuccess').textContent = "Copied to clipboard!";
}

document.getElementById('btnCopy').addEventListener('click', createDossierReport);
</script>
<!-- ------------------------ -->
<div id="MUGSHOT" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Mugshot</h4>
    </div>
    <div class="card-body">
      <form id="mugshotForm" autocomplete="off" novalidate>
        <div class="mb-3 row align-items-center">
          <label for="txtMDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtMDate" class="form-control" required />
          </div>
        </div>

        <div class="mb-4 row align-items-center">
          <label for="txtMLink" class="col-sm-3 col-form-label fw-bold text-end">Image Link:</label>
          <div class="col-sm-9">
            <input type="url" id="txtMLink" class="form-control" placeholder="https://example.com/image.png" required />
          </div>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-success px-4">Submit and Copy to Clipboard</button>
          <p id="copyMugshotSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <div class="mt-4">
          <label for="displayMugshotBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayMugshotBB" class="form-control" rows="8" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('mugshotForm');
    const dateInput = document.getElementById('txtMDate');
    const linkInput = document.getElementById('txtMLink');
    const output = document.getElementById('displayMugshotBB');
    const successMsg = document.getElementById('copyMugshotSuccess');

function formatDateDMY(dateStr) {
  if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
  const [year, month, day] = dateStr.split('-');
  const monthName = months[parseInt(month, 10) - 1] || '';
  return `${day}/${monthName}/${year}`;
}

const DateValRaw = dateInput.value;
const DateVal = formatDateDMY(DateValRaw);


    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

  const DateValRaw = dateInput.value;
  const DateVal = formatDateDMY(DateValRaw);

      const linkVal = linkInput.value.trim();

      const bbcode = `[spoiler=${DateVal}]
[img]${linkVal}[/img]
[/spoiler]`;

      output.value = bbcode.trim();
      output.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->

<div id="VEHICLE" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Vehicle Information</h4>
    </div>
    <div class="card-body">
      <form id="vehicleForm" autocomplete="off" novalidate>
        <div class="mb-3 row align-items-center">
          <label for="txtVOwner" class="col-sm-3 col-form-label fw-bold text-end">Registered Owner:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVOwner" class="form-control" placeholder="Owner Name" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtVModel" class="col-sm-3 col-form-label fw-bold text-end">Model:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVModel" class="form-control" placeholder="Vehicle Model" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtVColor" class="col-sm-3 col-form-label fw-bold text-end">Color:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVColor" class="form-control" placeholder="Vehicle Color" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtVLP" class="col-sm-3 col-form-label fw-bold text-end">License Plate (L/P):</label>
          <div class="col-sm-9">
            <input type="text" id="txtVLP" class="form-control" placeholder="License Plate" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtVIN" class="col-sm-3 col-form-label fw-bold text-end">VIN:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVIN" class="form-control" placeholder="Vehicle Identification Number" required />
          </div>
        </div>

        <div class="mb-4 row align-items-center">
          <label for="txtVLink" class="col-sm-3 col-form-label fw-bold text-end">Image Link:</label>
          <div class="col-sm-9">
            <input type="url" id="txtVLink" class="form-control" placeholder="https://example.com/image.png" />
          </div>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-success px-4">Submit and Copy to Clipboard</button>
          <p id="copyVehicleSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <div class="mt-4">
          <label for="displayVehicleBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayVehicleBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('vehicleForm');
    const ownerInput = document.getElementById('txtVOwner');
    const modelInput = document.getElementById('txtVModel');
    const colorInput = document.getElementById('txtVColor');
    const lpInput = document.getElementById('txtVLP');
    const vinInput = document.getElementById('txtVIN');
    const linkInput = document.getElementById('txtVLink');
    const output = document.getElementById('displayVehicleBB');
    const successMsg = document.getElementById('copyVehicleSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Owner = ownerInput.value.trim();
      const Model = modelInput.value.trim();
      const Color = colorInput.value.trim();
      const LP = lpInput.value.trim();
      const VIN = vinInput.value.trim();
      const image = linkInput.value.trim();

      const bbcode = `[spoiler=${Owner}, ${Model}, ${Color}, ${LP}]
[b]VIN:[/b] ${VIN}
${image ? `[img]${image}[/img]` : ''}
[/spoiler]`;

      output.value = bbcode.trim();
      output.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->

<div id="AFFIL" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Affiliate Information</h4>
    </div>
    <div class="card-body">
      <form id="affiliateForm" autocomplete="off" novalidate>
        <div class="mb-4 row align-items-center">
          <label for="txtAName" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtAName" class="form-control" placeholder="Affiliate Name" required />
          </div>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyAffiliateSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <div class="mt-4">
          <label for="displayAffiliateBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayAffiliateBB" class="form-control" rows="8" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('affiliateForm');
    const nameInput = document.getElementById('txtAName');
    const output = document.getElementById('displayAffiliateBB');
    const successMsg = document.getElementById('copyAffiliateSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const FName = nameInput.value.trim();
      const encodedName = encodeURIComponent(FName.replace(/ /g, "+"));

      const bbcode = `[*][url=search.php?keywords=${encodedName}][b]${FName}[/b][/url]`;

      output.value = bbcode.trim();
      output.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->
<!-- Multi-Arrest BBCode Generator: With Charge Selector + Modifiers -->
<div id="CHARGE" class="container mt-3 myHideableSection" style="max-width: 700px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Charge Information</h4>
    </div>
    <div class="card-body">
      <form id="chargeForm" autocomplete="off" novalidate>
        <div id="arrestEntrySection">
          <!-- Link -->
          <div class="mb-3 row align-items-center">
            <label for="txtChLink" class="col-sm-3 col-form-label fw-bold text-end">Link:</label>
            <div class="col-sm-9">
              <input type="url" id="txtChLink" class="form-control" placeholder="https://example.com/report" required />
            </div>
          </div>

          <!-- Date -->
          <div class="mb-3 row align-items-center">
            <label for="txtChDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
            <div class="col-sm-9">
              <input type="date" id="txtChDate" class="form-control" required />
            </div>
          </div>

          <!-- Charges List Selector with Modifiers -->
          <fieldset class="mb-4">
            <legend class="fw-bold text-white">Charges</legend>
            <div class="mb-2">
              <div class="row g-2 align-items-center">
                <div class="col-6 col-md-7">
                  <input type="text" id="chargeSearchBox" class="form-control mb-1" placeholder="Search charge code or phrase..." autocomplete="off" />
                </div>
                <div class="col-6 col-md-5">
                  <select id="modifierSelect" class="form-select mb-1">
                    <option value="">No Modifier</option>
                    <option value="Of Government Employee">Of Government Employee</option>
                    <option value="Accessory">Accessory</option>
                    <option value="Attempted">Attempted</option>
                    <option value="Aggravated">Aggravated</option>
                  </select>
                </div>
              </div>
              <div id="chargeSelectList" 
                   style="max-height:180px;overflow-y:auto;background:#fff;border:1px solid #dee2e6;padding:2px 2px 0 2px;border-radius:.25rem;position:relative;">
                <!-- JS will render -->
              </div>
            </div>
            <div class="input-group mb-2">
              <input type="text" id="txtpeopleInvolved" class="form-control" placeholder="Or type a custom charge..." autocomplete="off"/>
              <button type="button" id="btnAdd" class="btn btn-primary">Add Charge</button>
            </div>
            <ul id="peopleList" class="list-group list-group-flush" style="max-height: 160px; overflow-y: auto;"></ul>
            <button type="button" id="btnRemove" class="btn btn-danger mt-2">Remove Last Charge</button>
          </fieldset>
          
          <div class="mb-3 text-center">
            <button type="button" id="btnAddArrest" class="btn btn-info mb-2 px-4">Add Arrest Entry</button>
          </div>
        </div>

        <!-- List of Added Arrests -->
        <div class="mb-4">
          <h5 class="fw-bold text-white">Arrest Entries</h5>
          <ul id="arrestList" class="list-group"></ul>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" id="btnCopy" class="btn btn-success px-5">Submit and Copy BBCode</button>
          <p id="copyChargeSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayChargeBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayChargeBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// ==== Official Charge Codes ====
const allCharges = [
  "VC01 - Speeding 1st Degree",
  "VC02 - Speeding 2nd Degree",
  "VC03 - Speeding 3rd Degree",
  "VC04 - Illegal Parking",
  "VC05 - Improper Traffic Maneuvers",
  "VC06 - Following or Impeding Emergency Response",
  "VC07 - Operating a Vehicle Without A License On Your Person",
  "VC08 - Negligent Operation of a Road or Marine Vehicle",
  "VC09 - Blocking Intersection",
  "VC10 - Unroadworthy Vehicle",
  "VC11 - Failure to Pay a Toll",
  "VC12 - Operating an Unregistered Vehicle",
  "VC13 - Disruptive Impeding or Blocking Travel",
  "VC14 - Operation of a Vehicle without a License Plate",
  "GC01 - Loitering",
  "GC02 - Traffic Endangerment",
  "GC03 - Disorderly Conduct",
  "GC04 - Face Concealment",
  "GC05 - Misuse of Government Public Safety Radio Frequencies or Hotlines",
  "GC06 - Possession of Cannabis",
  "GM01 - Assault",
  "GM02 - Battery",
  "GM03 - Possession of a Blade",
  "GM04 - Resisting Arrest",
  "GM05 - Receiving Stolen Property",
  "GM06 - Petty Theft",
  "GM07 - Criminal Fraud",
  "GM08 - Vandalism",
  "GM09 - Vigilantism",
  "GM10 - Failure to Comply / Identify",
  "GM11 - Predatory Lending",
  "GM12 - Giving False Information to a Police Officer",
  "GM13 - Criminal Threats",
  "GM14 - Obstruction of Justice",
  "GM15 - Animal Cruelty",
  "GM16 - Failure to Pay a Fine",
  "GM17 - Bribery",
  "GM18 - Looting of a Dead Human Body",
  "GM19 - Face Concealment (b)",
  "GM20 - Minor Sales Tax Evasion",
  "GM21 - False Imprisonment",
  "GM22 - Contempt of Court",
  "GM23 - Parole Violation",
  "GM24 - Contempt of Congress",
  "GM25 - Possession/Unlawful use of Government Equipment",
  "GM26 - Possession of Illegal Information Gathering Devices",
  "GM27 - Incitement of Violence against a Peace Officer",
  "NM01 - Inciting a Riot",
  "NM02 - Participating in a Riot",
  "NM03 - Unlawful Assembly",
  "NM04 - Stalking",
  "NM05 - Public Intoxication",
  "NM06 - Trespassing",
  "NM07 - Prostitution, Pimping or Pandering",
  "NM08 - Abuse of Government Public Safety Radio Frequencies or Hotlines",
  "NM09 - Harassment",
  "VM01 - Operating a Vehicle without a Valid License",
  "VM02 - Operating a Vehicle with a Suspended License",
  "VM03 - Reckless Operation of a Road or Marine Vehicle",
  "VM05 - Drunk, Impaired, or Distracted Driving",
  "VM06 - Street Competition",
  "VM07 - Hit and Run",
  "VM08 - Vehicle Registration Fraud",
  "VM09 - Operation of a Vehicle without a License Plate",
  "VF01 - Evading an Officer",
  "VF02 - Felony Hit and Run",
  "VF03 - Operating a Chop Shop",
  "VF04 - Felony Public Endangerment",
  "DM01 - Possession of a Schedule I Controlled Substance",
  "DM02 - Possession of a Schedule II Controlled Substance",
  "DM03 - Possession of a Schedule III Controlled Substance",
  "DM04 - Possession of a Controlled Substance while Armed",
  "DM05 - Possession of Drug Paraphernalia",
  "DM06 - Cultivation of a Controlled Substance",
  "DF01 - Possession of a Controlled Substance with Intent of Sales",
  "DF02 - Sale of a Controlled Substance",
  "DF03 - Sale of Drug Paraphernalia",
  "DF04 - Trafficking a Controlled Substance",
  "DF05 - Manufacturing a Controlled Substance",
  "WM01 - Unlawful Brandishing of a Firearm or Weapon",
  "WM02 - Possession of a Class 1 Firearm",
  "WM03 - Criminal Use of Weapon Modifications",
  "WM04 - Possession of Illegal Body Armor",
  "WM05 - Possession of Body Armor as a Felon",
  "WF01 - Assault with a Deadly Weapon",
  "WF02 - Shooting from a Vehicle (Drive-By)",
  "WF03 - Possession of a Class 2 Firearm",
  "WF04 - Possession of a Class 3 Firearm",
  "WF05 - Possession of a Class 4 Firearm",
  "WF06 - Unlicensed transfer of firearms, ammunition and body armor",
  "WF07 - Firearms Trafficking",
  "GF01 - Child Endangerment",
  "GF02 - Robbery",
  "GF03 - Armed Robbery",
  "GF04 - Sexual Assault",
  "GF05 - Extortion",
  "GF06 - Blackmail",
  "GF07 - Felony Fraud",
  "GF08 - Illegal Gambling",
  "GF09 - Embezzlement",
  "GF10 - Grand Theft",
  "GF11 - Grand Theft Auto",
  "GF12 - Forgery or Counterfeiting",
  "GF13 - Arson",
  "GF14 - False Impersonation",
  "GF15 - Burglary",
  "GF16 - Tampering with Evidence",
  "GF17 - Rape",
  "GF18 - Racketeering",
  "GF19 - Abuse or Desecration of Dead Human Body",
  "GF20 - Possession of Human Body Tissue",
  "GF21 - Prison Break",
  "GF22 - Breach of Trust",
  "GF23 - Grand Sales Tax Evasion",
  "GF24 - Perjury",
  "GF25 - Felony Contempt of Court",
  "GF26 - Organized Assault on Government or Law Enforcement Operations",
  "GF27 - Incitement of Violence against a Peace Officer",
  "SF01 - Domestic Terrorism",
  "SF02 - Murder",
  "SF03 - Involuntary or Vehicular Manslaughter",
  "SF04 - Kidnapping",
  "SF05 - Torture",
  "SF06 - Possessing Destructive Devices or Explosives",
  "SF07 - Bank Robbery",
  "SF08 - Human Trafficking",
  "SF09 - False Imprisonment of a Hostage",
  "AM01 - Negligent Operation of an Aircraft",
  "AM02 - Operating an Unregistered Aircraft",
  "AM03 - Operating an Aircraft without a License on your Person",
  "AM04 - Disrupting Airport/Aircraft Operations",
  "AM05 - Operating an Aircraft without Proper Equipment",
  "AM06 - Failure to Make Way for Emergency, State Government, or Military Aircraft",
  "AM07 - Operating an Aircraft in Controlled Airspace without Clearance",
  "AM08 - Violating a Restricted Airspace Order or Temporary Flight Restriction",
  "AF01 - Reckless Operation of an Aircraft",
  "AF02 - Committing a Crime Aboard an Aircraft in Flight",
  "AF03 - Operating an Aircraft without an Active License",
  "AF04 - Failure to Obey Intercepting Military or Law Enforcement Aircraft/ATC Orders",
  "AF05 - Violating a Prohibited Airspace Order",
  "AF06 - Transporting Dangerous Cargo",
  "AF07 - Drunk, Impaired, or Distracted Flying",
  "AF08 - Aircraft Piracy",
  "AF09 - Destruction of an Aircraft or Aircraft Facilities",
  "AF10 - Disobeying a Grounding Order"
];

// Modifiers (can customize, reorder etc)
const modifiers = [
  { label: "No Modifier", value: "" },
  { label: "Of Government Employee", value: "Of Government Employee" },
  { label: "Accessory", value: "Accessory" },
  { label: "Attempted", value: "Attempted" },
  { label: "Aggravated", value: "Aggravated" }
];

function formatDateDMY(dateStr) {
  if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
  const [year, month, day] = dateStr.split('-');
  const monthName = months[parseInt(month, 10) - 1] || '';
  return `${day}/${monthName}/${year}`;
}

(() => {
  // DOM Elements
  const chargeForm = document.getElementById('chargeForm');
  const linkInput = document.getElementById('txtChLink');
  const dateInput = document.getElementById('txtChDate');
  const chargeInput = document.getElementById('txtpeopleInvolved');
  const addBtn = document.getElementById('btnAdd');
  const removeBtn = document.getElementById('btnRemove');
  const peopleList = document.getElementById('peopleList');
  const bbcodeOutput = document.getElementById('displayChargeBB');
  const successMsg = document.getElementById('copyChargeSuccess');
  const addArrestBtn = document.getElementById('btnAddArrest');
  const arrestList = document.getElementById('arrestList');
  const chargeSearchBox = document.getElementById('chargeSearchBox');
  const chargeSelectList = document.getElementById('chargeSelectList');
  const modifierSelect = document.getElementById('modifierSelect');

  const arrests = [];
  let currentCharges = [];

  // ---- Charge Selector Rendering ----
  function renderChargeList(query = '', selectedModifier = "") {
    const q = query.trim().toLowerCase();
    chargeSelectList.innerHTML = '';
    const filtered = allCharges.filter(c => !q || c.toLowerCase().includes(q));
    if (filtered.length === 0) {
      chargeSelectList.innerHTML = '<div style="padding:5px;">No matches.</div>';
      return;
    }
    filtered.forEach(charge => {
      // Compose preview charge with selected modifier
      const withModifier = applyModifierToCharge(selectedModifier, charge);
      const alreadyAdded = currentCharges.includes(withModifier);
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'btn btn-sm btn-light mb-1 w-100 text-start' + (alreadyAdded ? ' disabled text-body-secondary' : '');
      btn.textContent = withModifier;
      btn.style.border = alreadyAdded ? '1px solid #229' : '1px solid #eee';
      btn.onclick = alreadyAdded 
        ? null
        : () => {
            currentCharges.push(withModifier);
            updateChargesUI();
            renderChargeList(chargeSearchBox.value, modifierSelect.value);
          };
      chargeSelectList.appendChild(btn);
    });
  }

  // Compose the selected charge with the modifier
  function applyModifierToCharge(modifier, charge) {
    if (!modifier) return charge;
    // These should always prepend, *except* "Of Government Employee" which is appended
    if (modifier === "Of Government Employee") {
      return `${charge} Of Government Employee`;
    } else {
      return `${modifier} ${charge}`;
    }
  }

  // Whenever search or modifier changes, rerender list
  chargeSearchBox.addEventListener('input', () =>
    renderChargeList(chargeSearchBox.value, modifierSelect.value));
  modifierSelect.addEventListener('change', () =>
    renderChargeList(chargeSearchBox.value, modifierSelect.value));
  renderChargeList('', '');

  // ---- Manual-add charge (via input) ----
  addBtn.addEventListener('click', () => {
    const val = chargeInput.value.trim();
    if (!val) {
      alert('Please enter a charge description.');
      return;
    }
    // Compose with modifier
    const withModifier = applyModifierToCharge(modifierSelect.value, val);
    if (currentCharges.includes(withModifier)) {
      alert('Charge already added!');
      return;
    }
    currentCharges.push(withModifier);
    updateChargesUI();
    renderChargeList(chargeSearchBox.value, modifierSelect.value);
    chargeInput.value = '';
    chargeInput.focus();
  });

  removeBtn.addEventListener('click', () => {
    currentCharges.pop();
    updateChargesUI();
    renderChargeList(chargeSearchBox.value, modifierSelect.value);
  });

  function updateChargesUI() {
    peopleList.innerHTML = '';
    currentCharges.forEach((chrg, i) => {
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark d-flex justify-content-between align-items-center';
      li.innerHTML = `<span>${chrg}</span>`;
      // "Remove" button for each charge
      const delBtn = document.createElement('button');
      delBtn.type = 'button';
      delBtn.textContent = '✕';
      delBtn.className = 'btn btn-sm btn-outline-danger ms-2 py-0 px-2';
      delBtn.onclick = () => {
        currentCharges.splice(i, 1);
        updateChargesUI();
        renderChargeList(chargeSearchBox.value, modifierSelect.value);
      };
      li.appendChild(delBtn);
      peopleList.appendChild(li);
    });
  }

  addArrestBtn.addEventListener('click', () => {
    const link = linkInput.value.trim();
    const dateRaw = dateInput.value;
    const date = formatDateDMY(dateRaw);

    if (!link || !dateRaw || currentCharges.length === 0) {
      alert('Fill all fields and add at least one charge before adding an arrest.');
      return;
    }

    arrests.push({ link, date, charges: [...currentCharges], dateRaw });
    linkInput.value = '';
    dateInput.value = '';
    currentCharges = [];
    updateChargesUI();
    renderChargeList(chargeSearchBox.value, modifierSelect.value);
    updateArrestListUI();
  });

  function updateArrestListUI() {
    // Sort by dateRaw descending
    const sortedArrests = arrests.slice().sort((a, b) => b.dateRaw.localeCompare(a.dateRaw));
    arrestList.innerHTML = '';
    sortedArrests.forEach((arrest, idx) => {
      // Find original array index (for remove)
      const realIdx = arrests.findIndex(a => a.link === arrest.link && a.dateRaw === arrest.dateRaw && JSON.stringify(a.charges) === JSON.stringify(arrest.charges));
      const li = document.createElement('li');
      li.className = 'list-group-item d-flex justify-content-between align-items-start';
      li.innerHTML = `
        <div>
          <strong>${arrest.date}</strong> - <a href="${arrest.link}" target="_blank" style="color:#165ec5;">${arrest.link}</a>
          <br>
          <span class="badge bg-primary me-1">${arrest.charges.length} charge${arrest.charges.length !== 1 ? 's' : ''}</span>
          ${arrest.charges.map(c => `<span class="badge bg-secondary me-1">${c}</span>`).join('')}
        </div>
        <button type="button" data-idx="${realIdx}" class="btn btn-sm btn-danger remove-arrest">Remove</button>
      `;
      arrestList.appendChild(li);
    });
    document.querySelectorAll('.remove-arrest').forEach(btn => {
      btn.addEventListener('click', function() {
        const idx = parseInt(this.getAttribute('data-idx'), 10);
        arrests.splice(idx, 1);
        updateArrestListUI();
      });
    });
  }

  chargeForm.addEventListener('submit', e => {
    e.preventDefault();
    successMsg.textContent = '';
    if (arrests.length === 0) {
      alert('Please add at least one arrest entry.');
      return;
    }
    const sortedArrests = arrests.slice().sort((a, b) => b.dateRaw.localeCompare(a.dateRaw));
    const bbcode = sortedArrests.map(arrest =>
      `[*][url=${arrest.link}]${arrest.date} - ${arrest.charges.join(', ')}[/url]`
    ).join('\n');
    bbcodeOutput.value = bbcode;
    bbcodeOutput.select();
    try {
      navigator.clipboard.writeText(bbcode).then(() => {
        successMsg.textContent = 'Copied to clipboard!';
      }, () => {
        successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
      });
    } catch {
      successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
    }
  });
})();
</script>
<!-- ------------------------------------- -->

<div id="LOG" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Dossier Log</h4>
    </div>
    <div class="card-body">
      <form id="logForm" autocomplete="off" novalidate>
        <div class="mb-3 row align-items-center">
          <label for="txtLDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtLDate" class="form-control" required />
          </div>
        </div>

        <div class="mb-4 row align-items-center">
          <label for="txtLName" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtLName" class="form-control" placeholder="Name" required />
          </div>
        </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certMUG" checked>
            <label class="form-check-label" for="certMUG">
             Mugshot's
            </label>
                 </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certVEH">
            <label class="form-check-label" for="certVEH">
              Vehicle's
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certAFF">
            <label class="form-check-label" for="certAFF">
              Affiliate's 
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certArrest">
            <label class="form-check-label" for="certArrest">
              Arrest's
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certReacct">
            <label class="form-check-label" for="certReacct">
              Reactivated Dossier
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certMIA">
            <label class="form-check-label" for="certMIA">
              Archived Dossier - MIA
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="certDEP">
            <label class="form-check-label" for="certDEP">
              Archived Dossier - Deported
            </label>
          </div>
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyLOGSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <div class="mt-4">
          <label for="displayLOGBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayLOGBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('logForm');
    const dateInput = document.getElementById('txtLDate');
    const nameInput = document.getElementById('txtLName');
    const output = document.getElementById('displayLOGBB');
    const successMsg = document.getElementById('copyLOGSuccess');

function formatDateDMY(dateStr) {
  if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
  const [year, month, day] = dateStr.split('-');
  const monthName = months[parseInt(month, 10) - 1] || '';
  return `${day}/${monthName}/${year}`;
}

const DateValRaw = dateInput.value;
const DateVal = formatDateDMY(DateValRaw);

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

  const DateValRaw = dateInput.value;
  const DateVal = formatDateDMY(DateValRaw);
      const Name33 = nameInput.value.trim();


  let certs = '';
  if (document.getElementById('certMUG').checked) {
    certs += `[cbc] Mugshot's\n`;
  }

  if (document.getElementById('certVEH').checked) {
    certs += `[cbc] Vehicle's\n`;
  }

  if (document.getElementById('certAFF').checked) {
    certs += `[cbc] Affiliate's\n`;
  }

  if (document.getElementById('certArrest').checked) {
    certs += `[cbc] Arrest's\n`;
  }
  if (document.getElementById('certReacct').checked) {
    certs += `[cbc] Reactivated Dossier\n`;
  }
  if (document.getElementById('certMIA').checked) {
    certs += `[cbc] Marked Dossier Inactive - Has not been seen in awhile\n`;
  }
  if (document.getElementById('certDEP').checked) {
    certs += `[cbc] Marked Dossier Inactive - Has been deported from the city\n`;
  }



      const LOGTemplate = `[lspdfooter][/lspdfooter]
[divbox=white]
[mcdlogo=150][aligntable=right,0,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]Re:[/b] Dossier - ${Name33} [${DateVal}]

Following has been updated;
${certs}
 
[/list]
[hr][/hr]
[list=none]
Sincerely,
[fimg=300,70]https://imgur.com/p2ksyW2.png[/fimg]
[b] Police Detective I Mick Wegman[/b]
Major Crimes Unit, Detective Bureau
[b]Los Santos Police Department[/b][/list][/divbox] [lspdfooter][/lspdfooter]`;

      output.value = LOGTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(LOGTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>
<!-- ------------------------------------------------------- -->

<div id="CASEFILE" class="container mt-4 myHideableSection" style="max-width: 800px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h3>Casefile Creation</h3>
    </div>
    <div class="card-body">
      <form id="casefileForm" autocomplete="off" novalidate>
        <!-- Starting Date -->
        <div class="mb-3 row align-items-center">
          <label for="txtCaDate" class="col-sm-3 col-form-label fw-bold text-end">Starting Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtCaDate" class="form-control" required />
          </div>
        </div>

        <!-- Assigned Unit -->
        <div class="mb-3 row align-items-center">
          <label for="txtCaUnit" class="col-sm-3 col-form-label fw-bold text-end">Assigned Unit:</label>
          <div class="col-sm-9">
            <input type="text" id="txtCaUnit" class="form-control" placeholder="Unit name or code" required />
          </div>
        </div>

        <!-- Casefile Number -->
        <div class="mb-3 row align-items-center">
          <label for="txtCaNum" class="col-sm-3 col-form-label fw-bold text-end">Casefile Number:</label>
          <div class="col-sm-9">
            <input type="text" id="txtCaNum" class="form-control" placeholder="e.g. 12345" required />
          </div>
        </div>

        <!-- Overseeing Detective -->
        <div class="mb-4 row align-items-center">
          <label for="txtCaOver" class="col-sm-3 col-form-label fw-bold text-end">Overseeing Detective:</label>
          <div class="col-sm-9">
            <input type="text" id="txtCaOver" class="form-control" placeholder="Detective or Officer Name" required />
          </div>
        </div>

        <!-- Assigned Officers (Dynamic List) -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Assigned Officers</legend>
          <div class="input-group mb-2">
            <input type="text" id="txtCaUnits" class="form-control" placeholder="Enter officer name" />
            <button type="button" id="btnAddOfficer" class="btn btn-primary">Add</button>
          </div>
          <ul id="peopleList2" class="list-group list-group-flush" style="max-height: 150px; overflow-y: auto;"></ul>
          <button type="button" id="btnRemoveOfficer" class="btn btn-danger mt-2">Remove Last Officer</button>
        </fieldset>

        <!-- Report Links (Dynamic List) -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Reports</legend>
          <div class="row g-2 mb-2">
            <div class="col-sm-6">
              <input type="url" id="OLink" class="form-control" placeholder="Report Link (URL)" />
            </div>
            <div class="col-sm-6">
              <input type="text" id="OType" class="form-control" placeholder="Report Type/Description" />
            </div>
          </div>
          <button type="button" id="btnAddReport" class="btn btn-primary mb-2">Add Report</button>
          <ul id="itemList" class="list-group list-group-flush" style="max-height: 150px; overflow-y: auto;"></ul>
          <button type="button" id="btnRemoveReport" class="btn btn-danger mt-2">Remove Last Report</button>
        </fieldset>

        <!-- Narrative -->
        <div class="mb-4 row">
          <label for="txtCaNarr" class="col-sm-3 col-form-label fw-bold text-end">Narrative:</label>
          <div class="col-sm-9">
            <textarea id="txtCaNarr" class="form-control" rows="5" placeholder="Describe what happened..." required></textarea>
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" id="btnCopy" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyCaseSuccess" class="mt-2 text-success fw-bold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayCaseBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayCaseBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Date formatting helper: DD/Mon/YYYY
  function formatDateDDMMMYYYY(dateStr) {
    if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
    const [year, month, day] = dateStr.split('-');
    return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
  }

  (() => {
    const form = document.getElementById('casefileForm');
    const copySuccess = document.getElementById('copyCaseSuccess');
    const officerList = document.getElementById('peopleList2');
    const reportList = document.getElementById('itemList');
    const bbcodeOutput = document.getElementById('displayCaseBB');

    // Add officer
    document.getElementById('btnAddOfficer').addEventListener('click', () => {
      const input = document.getElementById('txtCaUnits');
      const val = input.value.trim();
      if (!val) {
        alert('Please enter an officer name.');
        return;
      }
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = val;
      officerList.appendChild(li);
      input.value = '';
      input.focus();
    });

    // Remove last officer
    document.getElementById('btnRemoveOfficer').addEventListener('click', () => {
      if (officerList.lastChild) officerList.removeChild(officerList.lastChild);
    });

    // Add report
    document.getElementById('btnAddReport').addEventListener('click', () => {
      const linkInput = document.getElementById('OLink');
      const typeInput = document.getElementById('OType');
      const link = linkInput.value.trim();
      const type = typeInput.value.trim();

      if (!link || !type) {
        alert('Please enter both report link and type/description.');
        return;
      }

      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = `${type}: ${link}`;
      reportList.appendChild(li);

      linkInput.value = '';
      typeInput.value = '';
      linkInput.focus();
    });

    // Remove last report
    document.getElementById('btnRemoveReport').addEventListener('click', () => {
      if (reportList.lastChild) reportList.removeChild(reportList.lastChild);
    });

    // Form submission
    form.addEventListener('submit', e => {
      e.preventDefault();
      copySuccess.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Gather form data
      const rawDate = document.getElementById('txtCaDate').value;
      const date = formatDateDDMMMYYYY(rawDate);
      const unit = document.getElementById('txtCaUnit').value.trim();
      const number = document.getElementById('txtCaNum').value.trim();
      const overseer = document.getElementById('txtCaOver').value.trim();
      const narrative = document.getElementById('txtCaNarr').value.trim();

      // Collect officers
      let officers = '';
      officerList.querySelectorAll('li').forEach(li => {
        officers += `${li.textContent}\n`;
      });

      // Collect reports
      let reports = '';
      reportList.querySelectorAll('li').forEach(li => {
        reports += `${li.textContent}\n`;
      });

      if (!officers) {
        alert('Please add at least one assigned officer.');
        return;
      }


      // Compose BBCode
      const bbcode = `[img]https://i.imgur.com/iqcYTGc.png[/img]

[lspdsubtitle]1. INFORMATION[/lspdsubtitle]
[divbox=white][list=none]
[b]Starting Date:[/b] ${date}
[b]Assigned Unit:[/b] ${unit}
[b]Case File Number:[/b] #${number}
[/list][hr]------------------CASE DETAILS------------------[/hr][list=none]
[b]Overseeing Detective / Officer:[/b] ${overseer}
[b]Detective(s) / Officer(s) - Assigned / Involved:[/b]
[list]
${officers}[/list]
[b]Case, Crime Report or Logs involved:[/b]
[list]
${reports}[/list]
[/divbox]

[lspdsubtitle]2. NARRATIVE[/lspdsubtitle]
[divbox=white]
${narrative}
[hr]
[img]SIGNATURE LINK[/img]
Police Detective I Mick Wegman
Los Santos Police Department
[/divbox]

[lspdsubtitle]3. EVIDENCE[/lspdsubtitle]
[divbox=white]
[hr]--------- ADD THE REQUIRED EVIDENCE MODULES FROM THE POST BELOW THIS ONE ------[hr]
[/divbox]

[lspdfooter][/lspdfooter]`;

      // Output and copy
      bbcodeOutput.value = bbcode.trim();
      bbcodeOutput.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          copySuccess.textContent = 'Copied to clipboard!';
        }, () => {
          copySuccess.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        copySuccess.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>


<!-- ------------------------ -->

<div id="SUSPECT" class="container myHideableSection mt-4" style="max-width: 800px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h3>Suspect Information</h3>
    </div>
    <div class="card-body">
      <form id="suspectForm" autocomplete="off" novalidate>
        <!-- Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtSName" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtSName" class="form-control" placeholder="John Doe" required />
          </div>
        </div>

        <!-- Image URL -->
        <div class="mb-3 row align-items-center">
          <label for="txtSImage" class="col-sm-3 col-form-label fw-bold text-end">Image URL:</label>
          <div class="col-sm-9">
            <input type="url" id="txtSImage" class="form-control" placeholder="https://i.imgur.com/oV6gumI.png" />
          </div>
        </div>

        <!-- Description -->
        <div class="mb-3 row align-items-center">
          <label for="txtSDescription" class="col-sm-3 col-form-label fw-bold text-end">Description:</label>
          <div class="col-sm-9">
            <input type="text" id="txtSDescription" class="form-control" placeholder="Skin, Gender, Hair, Facial Hair, Features, Clothing" />
          </div>
        </div>

        <!-- Phone Number -->
        <div class="mb-3 row align-items-center">
          <label for="txtSPhone" class="col-sm-3 col-form-label fw-bold text-end">Phone Number:</label>
          <div class="col-sm-9">
            <input type="tel" id="txtSPhone" class="form-control" placeholder="#1234567" />
          </div>
        </div>

        <!-- Known Vehicles -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Known Vehicles</legend>
          <div class="input-group mb-2">
            <input type="text" id="txtSModel" class="form-control" placeholder="Model (e.g. Black Buffalo)" />
            <input type="text" id="txtSLP" class="form-control" placeholder="Plate (e.g. ABC123)" />
            <button type="button" id="addVehicleBtn" class="btn btn-primary ms-2">Add Vehicle</button>
          </div>
          <ul id="vehicleList" class="list-group list-group-flush" style="max-height: 150px; overflow-y: auto;"></ul>
          <button type="button" id="removeVehicleBtn" class="btn btn-danger mt-2">Remove Last Vehicle</button>
        </fieldset>

        <!-- Additional Info -->
        <div class="mb-3 row align-items-center">
          <label for="txtSAdditional" class="col-sm-3 col-form-label fw-bold text-end">Additional Info:</label>
          <div class="col-sm-9">
            <input type="text" id="txtSAdditional" class="form-control" placeholder="Any extra details..." />
          </div>
        </div>

        <!-- Facing Charges -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Facing Charges</legend>
          <div class="input-group mb-2">
            <input type="text" id="txtSCharges" class="form-control" placeholder="CHARGECODE - CHARGENAME" />
            <button type="button" id="btnAddCharge" class="btn btn-primary ms-2">Add Charge</button>
          </div>
          <ul id="chargeList" class="list-group list-group-flush" style="max-height: 150px; overflow-y: auto;"></ul>
          <button type="button" id="btnRemoveCharge" class="btn btn-danger mt-2">Remove Last Charge</button>
        </fieldset>

        <!-- Submit -->
        <div class="text-center mt-4">
          <button type="submit" id="btnCopy" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copySuspectSuccess" class="text-success mt-2 fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displaySuspectBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displaySuspectBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('suspectForm');
    const vehicleModelInput = document.getElementById('txtSModel');
    const vehiclePlateInput = document.getElementById('txtSLP');
    const addVehicleBtn = document.getElementById('addVehicleBtn');
    const removeVehicleBtn = document.getElementById('removeVehicleBtn');
    const vehicleList = document.getElementById('vehicleList');

    const chargeInput = document.getElementById('txtSCharges');
    const addChargeBtn = document.getElementById('btnAddCharge');
    const removeChargeBtn = document.getElementById('btnRemoveCharge');
    const chargeList = document.getElementById('chargeList');

    const bbcodeOutput = document.getElementById('displaySuspectBB');
    const copySuccess = document.getElementById('copySuspectSuccess');

    // Helper to add list item with Bootstrap styling
    function addListItem(list, text) {
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = text;
      list.appendChild(li);
    }

    // Vehicles
    addVehicleBtn.addEventListener('click', () => {
      const model = vehicleModelInput.value.trim();
      const plate = vehiclePlateInput.value.trim();
      if (!model || !plate) {
        alert('Please enter both vehicle model and plate.');
        return;
      }
      addListItem(vehicleList, `${model} - [${plate}]`);
      vehicleModelInput.value = '';
      vehiclePlateInput.value = '';
      vehicleModelInput.focus();
    });

    removeVehicleBtn.addEventListener('click', () => {
      if (vehicleList.lastChild) vehicleList.removeChild(vehicleList.lastChild);
    });

    // Charges
    addChargeBtn.addEventListener('click', () => {
      const charge = chargeInput.value.trim();
      if (!charge) {
        alert('Please enter a charge.');
        return;
      }
      addListItem(chargeList, charge);
      chargeInput.value = '';
      chargeInput.focus();
    });

    removeChargeBtn.addEventListener('click', () => {
      if (chargeList.lastChild) chargeList.removeChild(chargeList.lastChild);
    });

    // Form submission
    form.addEventListener('submit', e => {
      e.preventDefault();
      copySuccess.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Name = document.getElementById('txtSName').value.trim();
      const image = document.getElementById('txtSImage').value.trim();
      const desc = document.getElementById('txtSDescription').value.trim();
      const phone = document.getElementById('txtSPhone').value.trim();
      const addit = document.getElementById('txtSAdditional').value.trim();

      const vehicles = [...vehicleList.querySelectorAll('li')]
        .map(li => li.textContent)
        .join('\n');

      const charges = [...chargeList.querySelectorAll('li')]
        .map(li => `[*] ${li.textContent}`)
        .join('\n');

      const bbcode = `[spoiler=Suspect - ${Name}]
[divbox=white][list=none]
[float=right][divbox=white][fimg=200,200]${image}[/fimg][/divbox][/float]
[b]Description:[/b] ${desc}
[b]Phone Number:[/b] #${phone}
[b]Known Vehicles:[/b]
[list]
${vehicles}
[/list]
[b]Additional Information:[/b]
${addit}
[b]Facing Charges:[/b]
[list]
${charges}
[/list]
[/divbox]
[/spoiler]`;

      bbcodeOutput.value = bbcode.trim();
      bbcodeOutput.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          copySuccess.textContent = 'Copied to clipboard!';
        }, () => {
          copySuccess.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        copySuccess.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->

<!-- Victim -->
<div id="VICTIM" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Victim/Witness Statment</h4>
    </div>
    <div class="card-body">
      <form id="VictimForm" autocomplete="off" novalidate>
        <!-- Link -->
        <div class="mb-3 row align-items-center">
          <label for="txtChLink" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVName" class="form-control" placeholder="FName LName" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtChLink" class="col-sm-3 col-form-label fw-bold text-end">Mugshot:</label>
          <div class="col-sm-9">
            <input type="url" id="txtVMugshot" class="form-control" placeholder="https://i.imgur.com/oV6gumI.png" required />
          </div>
        </div>

        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="txtChDate" class="col-sm-3 col-form-label fw-bold text-end">Phone:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPhone" class="form-control" required />
          </div>
        </div>

        <!-- Statement -->
        <div class="mb-3 row align-items-center">
          <label for="txtChDate" class="col-sm-3 col-form-label fw-bold text-end">Statement:</label>
          <div class="col-sm-9">
                  <textarea id="txtVStatement" class="form-control" rows="5" placeholder="Describe what happened..." required></textarea>
          </div>
        </div>

        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="txtChDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVDate" class="form-control" required />
          </div>
        </div>


        <!-- Submit -->
        <div class="text-center">
          <button type="submit" id="btnCopy" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyVictimSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayVictimBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayVictimBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const chargeForm = document.getElementById('VictimForm');
    const NameInput = document.getElementById('txtVName');
    const ImageInput = document.getElementById('txtVMugshot');;
    const PhoneInput = document.getElementById('txtVPhone');;
    const StatementInput = document.getElementById('txtVPhone');;
    const dateInput = document.getElementById('txtVDate');;
    const bbcodeOutput = document.getElementById('displayVictimBB');
    const successMsg = document.getElementById('copyVictimSuccess');


      const NameVal = NameInput.value.trim();
      const ImageVal = ImageInput.value;
      const PhoneVal = PhoneInput.value;
      const dateVal = dateInput.value;
      const StatementVal = StatementInput.value;

      const bbcode = `[spoiler=Victim/Witness - ${NameVal}][list=none]
[float=right][divbox=white][fimg=150,150]${ImageVal}[/fimg][/divbox][/float]
[b]Phone Number:[/b] ${PhoneVal}
[b]Statement:[/b] ${StatementVal}
[hr][/hr]
${dateVal}
Police Detective I
Los Santos Police Department
[/spoiler]`;

      bbcodeOutput.value = bbcode.trim();
      bbcodeOutput.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->

<div id="EVIDENCE" class="container mt-3 myHideableSection" style="max-width: 700px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Exhibit Creation</h4>
    </div>
    <div class="card-body">
      <form id="EvidenceForm" autocomplete="off" novalidate>
        <!-- Number -->
        <div class="mb-3 row align-items-center">
          <label for="txtENumber" class="col-sm-3 col-form-label fw-bold text-end">Number:</label>
          <div class="col-sm-9">
            <input type="text" id="txtENumber" class="form-control" placeholder="##" required />
          </div>
        </div>

        <!-- Item -->
        <div class="mb-3 row align-items-center">
          <label for="txtEItem" class="col-sm-3 col-form-label fw-bold text-end">Item:</label>
          <div class="col-sm-9">
            <input type="text" id="txtEItem" class="form-control" placeholder="Item" required />
          </div>
        </div>

        <!-- Image -->
        <div class="mb-3 row align-items-center">
          <label for="txtEImage" class="col-sm-3 col-form-label fw-bold text-end">Image URL:</label>
          <div class="col-sm-9">
            <input type="url" id="txtEImage" class="form-control" placeholder="https://i.imgur.com/oV6gumI.png" />
          </div>
        </div>

        <!-- Video -->
        <div class="mb-3 row align-items-center">
          <label for="txtEVideo" class="col-sm-3 col-form-label fw-bold text-end">Video URL:</label>
          <div class="col-sm-9">
            <input type="url" id="txtEVideo" class="form-control" placeholder="https://example.com/video.mp4" />
          </div>
        </div>

        <!-- Link -->
        <div class="mb-3 row align-items-center">
          <label for="txtELink" class="col-sm-3 col-form-label fw-bold text-end">Link:</label>
          <div class="col-sm-9">
            <input type="url" id="txtELink" class="form-control" placeholder="https://example.com" />
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" id="btnCopy" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyEvidenceSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayEvidenceBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayEvidenceBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('EvidenceForm');
    const numberInput = document.getElementById('txtENumber');
    const itemInput = document.getElementById('txtEItem');
    const imageInput = document.getElementById('txtEImage');
    const videoInput = document.getElementById('txtEVideo');
    const linkInput = document.getElementById('txtELink');
    const output = document.getElementById('displayEvidenceBB');
    const successMsg = document.getElementById('copyEvidenceSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const NumberVal = numberInput.value.trim();
      const ItemVal = itemInput.value.trim();
      const ImageVal = imageInput.value.trim();
      const VideoVal = videoInput.value.trim();
      const URLVal = linkInput.value.trim();

      // Build BBCode parts conditionally
      let bbcode = `[spoiler=Exhibit #${NumberVal}: ${ItemVal}][list=none]\n`;

      if (URLVal) {
        bbcode += `[url=${URLVal}]${URLVal}[/url]\n`;
      }
      if (ImageVal) {
        bbcode += `[img]${ImageVal}[/img]\n`;
      }
      if (VideoVal) {
        bbcode += `${VideoVal}\n`;
      }

      bbcode += `[/spoiler]`;

      output.value = bbcode.trim();
      output.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>


<!-- ------------------------------------- -->
<div id="OPERATION" class="container myHideableSection mt-4" style="max-width: 800px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h3>Operation Log</h3>
    </div>
    <div class="card-body">
      <form id="OperationForm" autocomplete="off" novalidate>
        <!-- Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtOName" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtOName" class="form-control" placeholder="Raid/Sting" required />
          </div>
        </div>

        <!-- Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtOName" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtODate" class="form-control" required />
          </div>
        </div>

        <!-- Detectives -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Detectives Involved</legend>
          <div class="input-group mb-2">
            <input type="text" id="txtORank" class="form-control" placeholder="Detective Rank" />
            <input type="text" id="txtODName" class="form-control" placeholder=John Doe" />
            <input type="text" id="txtOBr" class="form-control" placeholder="MCD/DSU/MCD" />

            <button type="button" id="addOperationBtn" class="btn btn-primary ms-2">Add Detective</button>
          </div>
          <ul id="OperationList" class="list-group list-group-flush" style="max-height: 150px; overflow-y: auto;"></ul>
          <button type="button" id="removeOperationBtn" class="btn btn-danger mt-2">Remove Last Detective</button>
        </fieldset>



        <!-- Description -->
        <div class="mb-3 row align-items-center">
          <label for="txtORun" class="col-sm-3 col-form-label fw-bold text-end">Rundown:</label>
          <div class="col-sm-9">
                  <textarea id="txtORun" class="form-control" rows="5" placeholder="Describe what happened..." required></textarea>
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center mt-4">
          <button type="submit" id="btnCopy" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyOperationSuccess" class="text-success mt-2 fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayOperationBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayOperationBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('OperationForm');
    const RankModelInput = document.getElementById('txtORank');
    const DetectiveInput = document.getElementById('txtODName');
    const BranchPlateInput = document.getElementById('txtOBr');

    const addOperationBtn = document.getElementById('addOperationBtn');
    const removeOperationBtn = document.getElementById('removeOperationBtn');
    const OperationList = document.getElementById('OperationList');

    const bbcodeOutput = document.getElementById('displayOperationBB');
    const copySuccess = document.getElementById('copyOperationSuccess');

    // Helper to add list item with Bootstrap styling
    function addListItem(list, text) {
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = text;
      list.appendChild(li);
    }

    // Vehicles
    addOperationBtn.addEventListener('click', () => {
      const rank = RankModelInput.value.trim();
      const detective = DetectiveInput.value.trim();
      const branch = BranchPlateInput.value.trim();
      if (!rank || !detective || !branch) {
        alert('Please enter both all fields.');
        return;
      } 
      addListItem(OperationList, `[*]${rank} ${detective} - ${branch}`);
      RankModelInput.value = '';
      DetectiveInput.value = '';
      BranchPlateInput.value = '';
      RankModelInput.focus();
    });

    removeOperationBtn.addEventListener('click', () => {
      if (OperationList.lastChild) OperationList.removeChild(OperationList.lastChild);
    });


    // Form submission
    form.addEventListener('submit', e => {
      e.preventDefault();
      copySuccess.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Name = document.getElementById('txtOName').value.trim();
      const date = document.getElementById('txtODate').value.trim();
      const events = document.getElementById('txtORun').value.trim();

      const vehicles = [...OperationList.querySelectorAll('li')]
        .map(li => li.textContent)
        .join('\n');


      const bbcode = `[spoiler=${Name} - ${date}]
[lspdsubtitle]${Name}[/lspdsubtitle]
[divbox=white][list=none]
[*]Investigators Involved
[list]
${vehicles}
[/list]
[hr]------------------OPERATION REPORT------------------[/hr]

${events}

[spoiler=Documentation]
[img]PHOTOGRAPHIC DOCUMENTATION[/img]
[url=VIDEO OR OTHER DOCUMENTATION]TITLE[/url]
[/spoiler]
[/list][/divbox]
[/spoiler]`;

      bbcodeOutput.value = bbcode.trim();
      bbcodeOutput.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          copySuccess.textContent = 'Copied to clipboard!';
        }, () => {
          copySuccess.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        copySuccess.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->

<div id="UPDATE" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Casefile Update</h4>
    </div>
    <div class="card-body">
      <form id="UPDATEForm" autocomplete="off" novalidate>
        <div class="mb-3 row align-items-center">
          <label for="txtLDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtCuDate" class="form-control" required />
          </div>
        </div>

        <div class="mb-4 row align-items-center">
          <label for="txtLName" class="col-sm-3 col-form-label fw-bold text-end">Update:</label>
          <div class="col-sm-9">
            <textarea id="txtCuUpdate" class="form-control" rows="3" placeholder="Update" required></textarea>
          </div>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyUPDATESuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <div class="mt-4">
          <label for="displayUPDATEBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayUPDATEBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('UPDATEForm');
    const dateInput = document.getElementById('txtCuDate');
    const UpdateInput = document.getElementById('txtCuUpdate');
    const output = document.getElementById('displayUPDATEBB');
    const successMsg = document.getElementById('copyUPDATESuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }
function formatDateDMY(dateStr) {
  if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
  const [year, month, day] = dateStr.split('-');
  const monthName = months[parseInt(month, 10) - 1] || '';
  return `${day}/${monthName}/${year}`;
}
const DateValRaw = dateInput.value;
const DateVal = formatDateDMY(DateValRaw);

      const Update = UpdateInput.value.trim();

      const UPDATETemplate = `[lspdfooter][/lspdfooter]
[divbox=white]
[mcdlogo=150][aligntable=right,0,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]Re:[/b] Casefile Update [${DateVal}]

${Update}

[/list]
[hr][/hr]
[list=none]
Sincerely,
[fimg=300,70]https://imgur.com/p2ksyW2.png[/fimg]
[b]Police Detective I Mick Wegman[/b]
Major Crimes Unit, Detective Bureau
[b]Los Santos Police Department[/b][/list][/divbox] [lspdfooter][/lspdfooter]`;

      output.value = UPDATETemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(UPDATETemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------------------------- -->


<div id="admissionGuilt" class="container mt-3 myHideableSection" style="max-width: 800px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Admission of Guilt Generator</h4>
    </div>
    <div class="card-body">
      <form id="admissionForm" autocomplete="off" novalidate>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="guiltDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="guiltDate" class="form-control" required />
          </div>
        </div>
        <!-- Suspect Name -->
        <div class="mb-3 row align-items-center">
          <label for="guiltName" class="col-sm-3 col-form-label fw-bold text-end">Suspect Name:</label>
          <div class="col-sm-9">
            <input type="text" id="guiltName" class="form-control" placeholder="Full Name" required />
          </div>
        </div>
        <!-- Phone Number -->
        <div class="mb-3 row align-items-center">
          <label for="guiltPhone" class="col-sm-3 col-form-label fw-bold text-end">Phone Number:</label>
          <div class="col-sm-9">
            <input type="text" id="guiltPhone" class="form-control" placeholder="Phone Number" required />
          </div>
        </div>
        <!-- Written Statement -->
        <div class="mb-4 row">
          <label for="guiltStatement" class="col-sm-3 col-form-label fw-bold text-end">Written Statement:</label>
          <div class="col-sm-9">
            <textarea id="guiltStatement" class="form-control" rows="5" placeholder="Enter written statement..." required></textarea>
          </div>
        </div>
        <!-- Charges -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Charges</legend>
          <div class="input-group mb-2">
            <input type="text" id="guiltChargeInput" class="form-control" placeholder="Enter charge" />
            <button type="button" id="guiltAddCharge" class="btn btn-primary">Add</button>
          </div>
          <ul id="guiltChargeList" class="list-group list-group-flush" style="max-height: 120px; overflow-y: auto;"></ul>
          <button type="button" id="guiltRemoveCharge" class="btn btn-danger mt-2">Remove Last Charge</button>
        </fieldset>
        <!-- Counsel Section -->
        <div class="mb-4">
          <label class="fw-bold mb-2">Legal Counsel:</label>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="counselType" id="counselPresent" value="present" checked>
            <label class="form-check-label" for="counselPresent">
              Legal Counsel Present
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="radio" name="counselType" id="counselWaived" value="waived">
            <label class="form-check-label" for="counselWaived">
              Waived Right to Legal Counsel
            </label>
          </div>
          <input type="text" id="counselName" class="form-control mb-2" placeholder="Counsel Name or [img]Link[/img]" />
        </div>
        <!-- Confessing Party -->
        <div class="mb-3 row align-items-center">
          <label for="confessingParty" class="col-sm-3 col-form-label fw-bold text-end">Confessing Party:</label>
          <div class="col-sm-9">
            <input type="text" id="confessingParty" class="form-control" placeholder="Name or [img]Link[/img]" required />
          </div>
        </div>
        <!-- Overseeing Detective/Officer -->
        <div class="mb-3 row align-items-center">
          <label for="overseeingOfficer" class="col-sm-3 col-form-label fw-bold text-end">Overseeing Detective/Officer:</label>
          <div class="col-sm-9">
            <input type="text" id="overseeingOfficer" class="form-control" placeholder="Rank Name or [img]Link[/img]" required />
          </div>
        </div>
        <!-- Proof of Roleplay -->
        <div class="mb-4 row">
          <label for="proofImages" class="col-sm-3 col-form-label fw-bold text-end">Proof of Roleplay:</label>
          <div class="col-sm-9">
            <input type="text" id="proofImages" class="form-control" placeholder="Image links, comma separated or [img]link[/img]" />
          </div>
        </div>
        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyGuiltSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayGuiltBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayGuiltBB" class="form-control" rows="16" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
function formatDateDDMMMYYYY(dateStr) {
  if (!dateStr) return '';
  const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
  const [year, month, day] = dateStr.split('-');
  return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
}

(() => {
  const form = document.getElementById('admissionForm');
  const chargeInput = document.getElementById('guiltChargeInput');
  const addChargeBtn = document.getElementById('guiltAddCharge');
  const removeChargeBtn = document.getElementById('guiltRemoveCharge');
  const chargeList = document.getElementById('guiltChargeList');
  const bbcodeOutput = document.getElementById('displayGuiltBB');
  const successMsg = document.getElementById('copyGuiltSuccess');

  // Add charge
  addChargeBtn.addEventListener('click', () => {
    const val = chargeInput.value.trim();
    if (!val) {
      alert('Please enter a charge.');
      return;
    }
    const li = document.createElement('li');
    li.className = 'list-group-item bg-light text-dark';
    li.textContent = val;
    chargeList.appendChild(li);
    chargeInput.value = '';
    chargeInput.focus();
  });

  // Remove last charge
  removeChargeBtn.addEventListener('click', () => {
    if (chargeList.lastChild) chargeList.removeChild(chargeList.lastChild);
  });

  // Handle form submission
  form.addEventListener('submit', e => {
    e.preventDefault();
    successMsg.textContent = '';

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    // Gather form data
    const dateRaw = document.getElementById('guiltDate').value;
    const date = formatDateDDMMMYYYY(dateRaw);
    const suspectName = document.getElementById('guiltName').value.trim();
    const phone = document.getElementById('guiltPhone').value.trim();
    const statement = document.getElementById('guiltStatement').value.trim();

    let charges = '';
    chargeList.querySelectorAll('li').forEach(li => {
      charges += `[*]${li.textContent}\n`;
    });

    if (!charges) {
      alert('Please add at least one charge.');
      return;
    }

    // Counsel
    const counselType = document.querySelector('input[name="counselType"]:checked').value;
    const counselName = document.getElementById('counselName').value.trim();

    // Confessing Party & Officer
    const confessingParty = document.getElementById('confessingParty').value.trim();
    const overseeingOfficer = document.getElementById('overseeingOfficer').value.trim();

    // Proof images
    const proofImages = document.getElementById('proofImages').value.trim();

    // Counsel section text
    let counselSection = '';
    if (counselType === 'present') {
      counselSection = `[cbc] Legal Counsel Present:
I had legal counsel present during the discussion and signing of this admission. All content and implications of this statement have been discussed and understood with my legal counsel's guidance.

[b]Counsel:[/b]
[font=cursive]${counselName}[/font]`;
    } else {
      counselSection = `[cbc] Waived Right to Legal Counsel:
I have been informed of and understand my right to legal counsel but have voluntarily chosen to waive this right, proceeding without consultation.`;
    }

    // BBCode template
    const bbcode = `[lspdfooter][/lspdfooter]

[divbox=white]
[dblogo=150][/dblogo][aligntable=right,350,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=115]ADMISSION OF GUILT[/size]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]

[mod=Detective Bureau]Lying on this document, willfully or otherwise, will nullify the stipulations of this agreement allowing the charges of GM12 - Giving False Information to a Police Officer, GM14 - Obstruction of Justice, and GF24 - Perjury.[/mod]
[hr]

[list=none][b][size=115]SUSPECT DETAILS[/size][/b]
[list=none]
[b]Date:[/b] ${date}

[b]Full Name:[/b] ${suspectName}
[b]Phone Number:[/b] ${phone}
[/list]


[b][size=115]WRITTEN STATEMENT (MANDATORY)[/size][/b]
[spoil]

${statement}

[/spoil]


[b][size=115]ADMISSION & SIGNATURE[/size][/b]
[list=none]
I, [b]${suspectName}[/b], hereby acknowledge the action(s) without coercion, intimidation, or other threat of physical harm to my person, property, or moral character. I state my formal admission to the crimes committed and knowingly wave my 5th Amendment Right to remain silent. I understand the charge(s) fully as stated:  

[list]
${charges}[/list]

I plead no contest to these listed crimes(s) and acknowledge both Civil implications and Criminal detainment and/or fines as confirmed by my signature below:
[/list]


[hr]


[b]Legal Counsel Acknowledgment/Waiver [/b]

${counselSection}


[hr]

[b]Confessing Party:[/b]
[font=cursive]${confessingParty}[/font]

[b]Overseeing Detective / Officer:[/b]
[font=cursive]${overseeingOfficer}[/font]


[spoiler=(( Proof of Roleplay ))]
${proofImages}
[/spoiler]
[/list]

[hr]
[/divbox]

[lspdfooter][/lspdfooter]`;

    bbcodeOutput.value = bbcode.trim();
    bbcodeOutput.focus();
    bbcodeOutput.select();

    try {
      navigator.clipboard.writeText(bbcode).then(() => {
        successMsg.textContent = 'Copied to clipboard!';
      }, () => {
        successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
      });
    } catch {
      successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
    }
  });
})();
</script>

<!-- ------------------------------------------------------- -->

<div id="traceLog" class="container mt-3 myHideableSection" style="max-width: 700px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: white;">
    <div class="card-header text-center">
      <h4>TRACE LOG Generator</h4>
    </div>
    <div class="card-body">
      <form id="traceForm" autocomplete="off" novalidate>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="traceDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="traceDate" class="form-control" required />
          </div>
        </div>
        <!-- Full Name -->
        <div class="mb-3 row align-items-center">
          <label for="traceName" class="col-sm-3 col-form-label fw-bold text-end">Full Name:</label>
          <div class="col-sm-9">
            <input type="text" id="traceName" class="form-control" placeholder="Full Name" required />
          </div>
        </div>
        <!-- Phone Number -->
        <div class="mb-4 row align-items-center">
          <label for="tracePhone" class="col-sm-3 col-form-label fw-bold text-end">Phone Number:</label>
          <div class="col-sm-9">
            <input type="text" id="tracePhone" class="form-control" placeholder="Phone Number" required />
          </div>
        </div>
        <div class="mb-3">
          <label class="fw-bold">Trace Criteria:</label>
          <div class="row g-2">
            <div class="col-md-6">
              <label class="form-label small">Serious Felony:</label>
              <select id="TR1" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Elusive Individual:</label>
              <select id="TR2" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Evasion with a Felony:</label>
              <select id="TR3" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Two Serious Misdemeanour:</label>
              <select id="TR4" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Individual on an active Casefile:</label>
              <select id="TR5" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Civilian in Mortal Danger:</label>
              <select id="TR6" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label small">Deviation Approved:</label>
              <select id="TR7" class="form-select form-select-sm">
                <option value="cb">No</option>
                <option value="cbc">Yes</option>
              </select>
            </div>
          </div>
        </div>




        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="traceCopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="traceBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="traceBBOutput" class="form-control" rows="14" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Format date as DD/MMM/YYYY (e.g. 07/May/2025)
  function formatDateDDMMMYYYY(dateStr) {
    if (!dateStr) return '';
    const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const [year, month, day] = dateStr.split('-');
    return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
  }

  document.getElementById('traceForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const successMsg = document.getElementById('traceCopySuccess');
    successMsg.textContent = '';

    if (!this.checkValidity()) {
      this.reportValidity();
      return;
    }

    const dateRaw = document.getElementById('traceDate').value;
    const date = formatDateDDMMMYYYY(dateRaw);
    const name = document.getElementById('traceName').value.trim();
    const phone = document.getElementById('tracePhone').value.trim();


  // Criteria
  const TR = [];
  for(let i=1; i<= 7; i++) {
    TR[i] = document.getElementById('TR'+i).value;
  }

    const bbcode = `[lspdfooter][/lspdfooter]

[divbox=white]
[dblogo=150][/dblogo][aligntable=right,350,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=115]TRACE LOG[/size]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none][b][size=115]TRACE DETAILS[/size][/b]
[list=none]
[b]Date[/b]: ${date}

[b]Full Name[/b]: ${name}
[b]Phone Number[/b]: ${phone}
[/list]


[b][size=115]TRACE REASON[/size][/b]
[list=none]
[${TR[1]}] Serious Felony
[${TR[2]}] Elusive Individual
[${TR[3]}] Evasion with a Felony
[${TR[4]}] Two Serious Misdemeanour
[${TR[5]}] Individual on an active Casefile
[${TR[6]}] Civilian in Mortal Danger
[${TR[7]}] Deviation Approved
[/list]
[/divbox]
[lspdfooter][/lspdfooter]`;

    const outputArea = document.getElementById('traceBBOutput');
    outputArea.value = bbcode.trim();
    outputArea.focus();
    outputArea.select();

    try {
      navigator.clipboard.writeText(bbcode).then(() => {
        successMsg.textContent = 'Copied to clipboard!';
      }, () => {
        successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
      });
    } catch {
      successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
    }
  });
</script>

<!-- ------------------------------------------------------- -->

<div id="radioFrequencyLog" class="container mt-3 myHideableSection" style="max-width: 700px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: white;">
    <div class="card-header text-center">
      <h4>RADIO FREQUENCY LOG Generator</h4>
    </div>
    <div class="card-body">
      <form id="radioForm" autocomplete="off" novalidate>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="radioDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="radioDate" class="form-control" required />
          </div>
        </div>
        <!-- Frequency -->
        <div class="mb-3 row align-items-center">
          <label for="radioFrequency" class="col-sm-3 col-form-label fw-bold text-end">Frequency:</label>
          <div class="col-sm-9">
            <input type="text" id="radioFrequency" class="form-control" placeholder="Frequency" required />
          </div>
        </div>
        <!-- Source -->
        <div class="mb-3 row align-items-center">
          <label for="radioSource" class="col-sm-3 col-form-label fw-bold text-end">Source:</label>
          <div class="col-sm-9">
            <input type="text" id="radioSource" class="form-control" placeholder="Fname Lname - PHONE, deceased individual, etc" required />
          </div>
        </div>
        <!-- Situation -->
        <div class="mb-4 row align-items-center">
          <label for="radioSituation" class="col-sm-3 col-form-label fw-bold text-end">Situation:</label>
          <div class="col-sm-9">
            <textarea id="radioSituation" class="form-control" rows="4" placeholder="Describe the situation..." required></textarea>
          </div>
        </div>
        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="radioCopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="radioBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="radioBBOutput" class="form-control" rows="14" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Format date as DD/MMM/YYYY (e.g. 07/May/2025)
  function formatDateDDMMMYYYY(dateStr) {
    if (!dateStr) return '';
    const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const [year, month, day] = dateStr.split('-');
    return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
  }

  document.getElementById('radioForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const successMsg = document.getElementById('radioCopySuccess');
    successMsg.textContent = '';

    if (!this.checkValidity()) {
      this.reportValidity();
      return;
    }

    const dateRaw = document.getElementById('radioDate').value;
    const date = formatDateDDMMMYYYY(dateRaw);
    const frequency = document.getElementById('radioFrequency').value.trim();
    const source = document.getElementById('radioSource').value.trim();
    const situation = document.getElementById('radioSituation').value.trim();

    const bbcode = `[lspdfooter][/lspdfooter]

[divbox=white]
[dblogo=150][/dblogo][aligntable=right,350,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=115]RADIO FREQUENCY LOG[/size]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none][b][size=115]FREQUENCY DETAILS[/size][/b]
[list=none]
[b]Date:[/b] ${date}

[b]Frequency:[/b] ${frequency}
[b]Source:[/b] ${source}
[b]Situation:[/b] ${situation}

[/list]
[/divbox]

[lspdfooter][/lspdfooter]`;

    const outputArea = document.getElementById('radioBBOutput');
    outputArea.value = bbcode.trim();
    outputArea.focus();
    outputArea.select();

    try {
      navigator.clipboard.writeText(bbcode).then(() => {
        successMsg.textContent = 'Copied to clipboard!';
      }, () => {
        successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
      });
    } catch {
      successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
    }
  });
</script>

<!-- ------------------------------------- -->

<div id="narcoticsConfiscation" class="container mt-3 myHideableSection" style="max-width: 800px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: white;">
    <div class="card-header text-center">
      <h4>Narcotics Confiscation Report Generator</h4>
    </div>
    <div class="card-body">
      <form id="narcoticsForm" autocomplete="off" novalidate>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="confiscationDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="confiscationDate" class="form-control" required />
          </div>
        </div>
        <!-- Full Name -->
        <div class="mb-3 row align-items-center">
          <label for="confiscationName" class="col-sm-3 col-form-label fw-bold text-end">Full Name:</label>
          <div class="col-sm-9">
            <input type="text" id="confiscationName" class="form-control" placeholder="Full Name" required />
          </div>
        </div>
        <!-- Phone Number -->
        <div class="mb-3 row align-items-center">
          <label for="confiscationPhone" class="col-sm-3 col-form-label fw-bold text-end">Phone Number:</label>
          <div class="col-sm-9">
            <input type="text" id="confiscationPhone" class="form-control" placeholder="Phone Number" required />
          </div>
        </div>
        <!-- Location of Discovery -->
        <div class="mb-3 row align-items-center">
          <label for="confiscationLocation" class="col-sm-3 col-form-label fw-bold text-end">Location of Discovery:</label>
          <div class="col-sm-9">
            <input type="text" id="confiscationLocation" class="form-control" placeholder="Location of Discovery" required />
          </div>
        </div>
        <!-- Narcotic Substances -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Narcotic Details (Substances)</legend>
          <div class="input-group mb-2">
            <input type="text" id="substanceInput" class="form-control" placeholder="e.g. 5 gram(s) Cocaine Schedule: II" />
            <button type="button" id="addSubstanceBtn" class="btn btn-primary">Add Substance</button>
          </div>
          <ul id="substanceList" class="list-group list-group-flush" style="max-height: 120px; overflow-y: auto;"></ul>
          <button type="button" id="removeSubstanceBtn" class="btn btn-danger mt-2">Remove Last Substance</button>
        </fieldset>
        <!-- Components -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Components</legend>
          <div class="input-group mb-2">
            <input type="text" id="componentInput" class="form-control" placeholder="e.g. 10 gram(s) Cannabis Leaf" />
            <button type="button" id="addComponentBtn" class="btn btn-primary">Add Component</button>
          </div>
          <ul id="componentList" class="list-group list-group-flush" style="max-height: 120px; overflow-y: auto;"></ul>
          <button type="button" id="removeComponentBtn" class="btn btn-danger mt-2">Remove Last Component</button>
        </fieldset>
        <!-- Confiscation Narrative -->
        <div class="mb-4 row">
          <label for="confiscationNarrative" class="col-sm-3 col-form-label fw-bold text-end">Confiscation Narrative:</label>
          <div class="col-sm-9">
            <textarea id="confiscationNarrative" class="form-control" rows="6" placeholder="Enter narrative..." required></textarea>
          </div>
        </div>
        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="confiscationCopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="confiscationBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="confiscationBBOutput" class="form-control" rows="18" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Date formatter DD/MMM/YYYY
  function formatDateDDMMMYYYY(dateStr) {
    if (!dateStr) return '';
    const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const [year, month, day] = dateStr.split('-');
    return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
  }

  (() => {
    const form = document.getElementById('narcoticsForm');
    const addSubstanceBtn = document.getElementById('addSubstanceBtn');
    const removeSubstanceBtn = document.getElementById('removeSubstanceBtn');
    const substanceInput = document.getElementById('substanceInput');
    const substanceList = document.getElementById('substanceList');

    const addComponentBtn = document.getElementById('addComponentBtn');
    const removeComponentBtn = document.getElementById('removeComponentBtn');
    const componentInput = document.getElementById('componentInput');
    const componentList = document.getElementById('componentList');

    const successMsg = document.getElementById('confiscationCopySuccess');
    const bbcodeOutput = document.getElementById('confiscationBBOutput');

    // Add substance
    addSubstanceBtn.addEventListener('click', () => {
      const val = substanceInput.value.trim();
      if (!val) {
        alert('Please enter a substance detail.');
        return;
      }
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = val;
      substanceList.appendChild(li);
      substanceInput.value = '';
      substanceInput.focus();
    });

    // Remove last substance
    removeSubstanceBtn.addEventListener('click', () => {
      if (substanceList.lastChild) substanceList.removeChild(substanceList.lastChild);
    });

    // Add component
    addComponentBtn.addEventListener('click', () => {
      const val = componentInput.value.trim();
      if (!val) {
        alert('Please enter a component detail.');
        return;
      }
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = val;
      componentList.appendChild(li);
      componentInput.value = '';
      componentInput.focus();
    });

    // Remove last component
    removeComponentBtn.addEventListener('click', () => {
      if (componentList.lastChild) componentList.removeChild(componentList.lastChild);
    });

    // Form submit
    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const dateRaw = document.getElementById('confiscationDate').value;
      const date = formatDateDDMMMYYYY(dateRaw);
      const name = document.getElementById('confiscationName').value.trim();
      const phone = document.getElementById('confiscationPhone').value.trim();
      const location = document.getElementById('confiscationLocation').value.trim();
      const narrative = document.getElementById('confiscationNarrative').value.trim();

      let substances = '';
      substanceList.querySelectorAll('li').forEach(li => {
        substances += `[b]Substance(s):[/b] ${li.textContent}\n`;
      });

      let components = '';
      componentList.querySelectorAll('li').forEach(li => {
        components += `[b]Component(s):[/b] ${li.textContent}\n`;
      });



      const bbcode = `[lspdfooter][/lspdfooter]

[divbox=white]
[dblogo=150][/dblogo][aligntable=right,350,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=115]NARCOTICS CONFISCATION REPORT[/size]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none][b][size=115]CONFISCATION DETAILS[/size][/b]
[list=none]
[b]Date:[/b] ${date}

[b]Full Name:[/b] ${name}
[b]Phone Number:[/b] ${phone}
[b]Location of Discovery:[/b] ${location}
[/list]


[b][size=115]NARCOTIC DETAILS[/size][/b]
[list=none]
${substances}
${components}
[/list]


[b][size=115]CONFISCATION NARRATIVE[/size][/b]
[list=none]
${narrative}

[/list]
[/divbox]

[lspdfooter][/lspdfooter]`;

      bbcodeOutput.value = bbcode.trim();
      bbcodeOutput.focus();
      bbcodeOutput.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>


<!-- ------------------------------------- -->

<div id="monetaryRecovery" class="container mt-3 myHideableSection" style="max-width: 700px;">
  <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: white;">
    <div class="card-header text-center">
      <h4>Monetary Recovery Report Generator</h4>
    </div>
    <div class="card-body">
      <form id="monetaryForm" autocomplete="off" novalidate>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="recoveryDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="recoveryDate" class="form-control" required />
          </div>
        </div>
        <!-- Person in Possession -->
        <div class="mb-3 row align-items-center">
          <label for="personPossession" class="col-sm-3 col-form-label fw-bold text-end">Person in Possession:</label>
          <div class="col-sm-9">
            <input type="text" id="personPossession" class="form-control" placeholder="Fname Lname - PHONE" required />
          </div>
        </div>
        <!-- Others Involved -->
        <fieldset class="mb-4">
          <legend class="fw-bold">Others Involved</legend>
          <div class="input-group mb-2">
            <input type="text" id="othersInvolvedInput" class="form-control" placeholder="Fname Lname - PHONE" />
            <button type="button" id="addOtherBtn" class="btn btn-primary">Add</button>
          </div>
          <ul id="othersInvolvedList" class="list-group list-group-flush" style="max-height: 130px; overflow-y: auto;"></ul>
          <button type="button" id="removeOtherBtn" class="btn btn-danger mt-2">Remove Last</button>
        </fieldset>
        <!-- Monetary Details -->
        <div class="mb-3 row align-items-center">
          <label for="amountRecovered" class="col-sm-3 col-form-label fw-bold text-end">Amount:</label>
          <div class="col-sm-9">
            <input type="text" id="amountRecovered" class="form-control" placeholder="$0000" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="typeRecovered" class="col-sm-3 col-form-label fw-bold text-end">Type:</label>
          <div class="col-sm-9">
            <input type="text" id="typeRecovered" class="form-control" placeholder="Packed Cash, etc." required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="sourceRecovered" class="col-sm-3 col-form-label fw-bold text-end">Source:</label>
          <div class="col-sm-9">
            <input type="text" id="sourceRecovered" class="form-control" placeholder="Store, Bank, Suspect, etc." required />
          </div>
        </div>
        <!-- Recovery Narrative -->
        <div class="mb-4 row">
          <label for="recoveryNarrative" class="col-sm-3 col-form-label fw-bold text-end">Recovery Narrative:</label>
          <div class="col-sm-9">
            <textarea id="recoveryNarrative" class="form-control" rows="6" placeholder="Enter narrative..." required></textarea>
          </div>
        </div>
        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="recoveryCopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="recoveryBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="recoveryBBOutput" class="form-control" rows="18" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  function formatDateDDMMMYYYY(dateStr) {
    if (!dateStr) return '';
    const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const [year, month, day] = dateStr.split('-');
    return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
  }

  (() => {
    const form = document.getElementById('monetaryForm');
    const addOtherBtn = document.getElementById('addOtherBtn');
    const removeOtherBtn = document.getElementById('removeOtherBtn');
    const othersInput = document.getElementById('othersInvolvedInput');
    const othersList = document.getElementById('othersInvolvedList');
    const successMsg = document.getElementById('recoveryCopySuccess');
    const bbcodeOutput = document.getElementById('recoveryBBOutput');

    addOtherBtn.addEventListener('click', () => {
      const val = othersInput.value.trim();
      if (!val) {
        alert('Please enter a name and phone for others involved.');
        return;
      }
      const li = document.createElement('li');
      li.className = 'list-group-item bg-light text-dark';
      li.textContent = val;
      othersList.appendChild(li);
      othersInput.value = '';
      othersInput.focus();
    });

    removeOtherBtn.addEventListener('click', () => {
      if (othersList.lastChild) othersList.removeChild(othersList.lastChild);
    });

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const dateRaw = document.getElementById('recoveryDate').value;
      const date = formatDateDDMMMYYYY(dateRaw);
      const person = document.getElementById('personPossession').value.trim();

      let others = '';
      othersList.querySelectorAll('li').forEach(li => {
        others += `[*]${li.textContent}\n`;
      });

      const amount = document.getElementById('amountRecovered').value.trim();
      const type = document.getElementById('typeRecovered').value.trim();
      const source = document.getElementById('sourceRecovered').value.trim();
      const narrative = document.getElementById('recoveryNarrative').value.trim();



      const bbcode = `[lspdfooter][/lspdfooter]

[divbox=white]
[dblogo=150][/dblogo][aligntable=right,350,0,0,0,0,#FFFFFF][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=115]MONETARY RECOVERY REPORT[/size]
[size=95]"TO PROTECT AND TO SERVE"[/size][/font][/right][/aligntable]
[hr]
[list=none][b][size=115]RECOVERY DETAILS[/size][/b]
[list=none]
[b]Date:[/b] ${date}

[b]Person in Possession:[/b] ${person}
[b]Others Involved:[/b]
[list]
${others}
[/list]
[/list]


[b][size=115]MONETARY DETAILS[/size][/b]
[list=none]
[b]Amount:[/b] [color=green]${amount}[/color]
[b]Type:[/b] ${type}
[b]Source:[/b] ${source}
[/list]


[b][size=115]RECOVERY NARRATIVE[/size][/b]
[list=none]
${narrative}

[/list]
[/divbox]

[lspdfooter][/lspdfooter]`;

      bbcodeOutput.value = bbcode.trim();
      bbcodeOutput.focus();
      bbcodeOutput.select();

      try {
        navigator.clipboard.writeText(bbcode).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>


<!-- ------------------------------------------------------- -->

<div id="K9" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Canine Report</h4>
    </div>
    <div class="card-body">
      <form id="canineForm" autocomplete="off" novalidate>
        <div class="mb-3 row align-items-center">
          <label for="txtK9Name" class="col-sm-3 col-form-label fw-bold text-end">Rank and Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtK9Name" class="form-control" placeholder="Your Rank and Name" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtK9Other" class="col-sm-3 col-form-label fw-bold text-end">Other Officers:</label>
          <div class="col-sm-9">
            <input type="text" id="txtK9Other" class="form-control" placeholder="Other Officers Involved (if any)" />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtK9Date" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtK9Date" class="form-control" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtK9Time" class="col-sm-3 col-form-label fw-bold text-end">Time (UTC):</label>
          <div class="col-sm-9">
            <input type="txt" id="txtK9Time" class="form-control" placeholder="XX:XX > XX:XX" required />
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtK9Sum" class="col-sm-3 col-form-label fw-bold text-end">Summary:</label>
          <div class="col-sm-9">
            <textarea id="txtK9Sum" class="form-control" rows="3" placeholder="Patrol Summary" required></textarea>
          </div>
        </div>

        <div class="mb-3 row align-items-center">
          <label for="txtK9Depl" class="col-sm-3 col-form-label fw-bold text-end">Deployments:</label>
          <div class="col-sm-9">
            <input type="number" id="txtK9Depl" class="form-control" min="0" placeholder="Number of K9 Releases" />
          </div>
        </div>

        <div class="mb-4 row align-items-center">
          <label for="txtK9Paper" class="col-sm-3 col-form-label fw-bold text-end">Paperwork Link:</label>
          <div class="col-sm-9">
            <input type="url" id="txtK9Paper" class="form-control" placeholder="Link to supporting paperwork" />
          </div>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyCanineSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <div class="mt-4">
          <label for="displayCanineBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayCanineBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('canineForm');
    const officerInput = document.getElementById('txtK9Name');
    const otherInput = document.getElementById('txtK9Other');
    const dateInput = document.getElementById('txtK9Date');
    const timeInput = document.getElementById('txtK9Time');
    const summaryInput = document.getElementById('txtK9Sum');
    const deploymentsInput = document.getElementById('txtK9Depl');
    const paperworkInput = document.getElementById('txtK9Paper');
    const output = document.getElementById('displayCanineBB');
    const successMsg = document.getElementById('copyCanineSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Officer = officerInput.value.trim();
      const Other = otherInput.value.trim() || '[i]If any[/i]';
      const DateVal = dateInput.value;
      const Time = timeInput.value;
      const Summary = summaryInput.value.trim();
      const Deployments = deploymentsInput.value || '0';
      const Paperwork = paperworkInput.value.trim() || '[i]Insert link if any[/i]';

      const CanineTemplate = `[img]https://i.imgur.com/9rg9GNR.png[/img]
[lspdsubtitle]PATROL DETAILS[/lspdsubtitle]
[divbox=white]
[b]Your Rank and Name[/b]: ${Officer}
[b]Other Officers involved[/b]: ${Other}
[i]List involved officers here.[/i]

[b]Date[/b]: ${DateVal}
[b]Time ((UTC))[/b]: ${Time}
[hr]-[/hr]

[b]Patrol Summary:[/b]
${Summary}

[b]Release of K9 count[/b]: [b][i]${Deployments}[/i][/b]

[hr]-[/hr]

[b]Did you fill out any supporting paperwork i.e. duty reports?[/b] [i]If so link them[/i]:

[url]${Paperwork}[/url]

[b]Additional Notes[/b] [i]OPTIONAL[/i]:
[i]Insert additional notes here.[/i]

[/divbox]
[img]https://i.imgur.com/88vzzHs.jpg[/img]`;

      output.value = CanineTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(CanineTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------------------------- -->

<!-- Include Bootstrap 5 CSS in your <head> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

<div id="FPS" class="container mt-3 myHideableSection" style="max-width: 900px; display: none;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Field Performance Session (FPS) Report</h4>
    </div>
    <div class="card-body">
      <form id="fpsForm" autocomplete="off" novalidate>
        <!-- Date & Time -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtFPSDate" class="form-control" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFPSTime" class="col-sm-3 col-form-label fw-bold text-end">Time:</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSTime" class="form-control" required />
          </div>
        </div>
        <!-- Modules -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSMod" class="col-sm-3 col-form-label fw-bold text-end">Modules:</label>
          <div class="col-sm-9">
            <textarea id="txtFPSMod" class="form-control" rows="6" required>
[spoil]
[list=none] 
[*] [cb] - [b]Conducted an arrest[/b]
[*] [cb] - [b]Conducted a traffic stop (10-55)[/b]
[*] [cb] - [b]Participated in a vehicle pursuit[/b]
[*] [cb] - [b]Primary in a vehicle pursuit[/b]
[*] [cb] - [url=viewtopic.php?p=40453#203][b]Conducted a Mock Pursuit[/b][/url]
[/list]
[hr]
[list=none] 
[*] [cb] - [b]Created a BOLO[/b]
[*] [cb] - [b]Issued a citation[/b]
[*] [cb] - [b]Impounded a vehicle[/b]
[*] [cb] - [b]Released a vehicle[/b]
[*] [cb] - [b]Conducted a felony stop (10-66)[/b]
[/list]
[hr]
[list=none] 
[*] [cb] - [b]Investigated a 911 call[/b]
[*] [cb] - [b]Responded to a robbery call[/b]
[*] [cb] - [b]Reviewed CCTV footage[/b]
[*] [cb] - [b]Conducted a basic investigation[/b]
[*] [cb] - [b]Gathered a statement[/b]
[*] [cb] - [b]Handled evidence outside of an arrest[/b]
[/list]
[hr]
[list=none] 
[*] [cb] - [b]Remained calm in a stressful situation[/b]
[*] [cb] - [b]Relayed information over a tactical frequency[/b]
[*] [cb] - [b]Used the department radio[/b]
[*] [cb] - [b]Responded to a report status (10-21)[/b]
[*] [cb] - [b]Participated in a roll call (10-1)[/b]
[/list]
[/spoil]
            </textarea>
          </div>
        </div>
        <!-- Timeline -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSLine" class="col-sm-3 col-form-label fw-bold text-end">Timeline:</label>
          <div class="col-sm-9">
            <textarea id="txtFPSLine" class="form-control" rows="8" placeholder="Minimum of 100 words" required></textarea>
          </div>
        </div>
        <!-- Grading Sections -->
        <!-- Repeat the following block for each grading area -->
        <!-- General attitude, demeanor and confidence -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSGen1" class="col-sm-3 col-form-label fw-bold text-end">General attitude, demeanor and confidence:</label>
          <div class="col-sm-3 mb-2 mb-sm-0">
            <input type="text" id="txtFPSGen1" class="form-control" placeholder="GOOD / OKAY / POOR / N/A" required />
          </div>
          <div class="col-sm-6">
            <textarea id="txtFPSGen2" class="form-control" rows="2" placeholder="Minimum of 25 words" required></textarea>
          </div>
        </div>
        <!-- Field awareness -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSField1" class="col-sm-3 col-form-label fw-bold text-end">Field awareness, police tasks, use of force:</label>
          <div class="col-sm-3 mb-2 mb-sm-0">
            <input type="text" id="txtFPSField1" class="form-control" placeholder="GOOD / OKAY / POOR / N/A" required />
          </div>
          <div class="col-sm-6">
            <textarea id="txtFPSField2" class="form-control" rows="2" placeholder="Minimum of 25 words" required></textarea>
          </div>
        </div>
        <!-- Departmental procedures and protocols -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSMan1" class="col-sm-3 col-form-label fw-bold text-end">Departmental procedures and protocols:</label>
          <div class="col-sm-3 mb-2 mb-sm-0">
            <input type="text" id="txtFPSMan1" class="form-control" placeholder="GOOD / OKAY / POOR / N/A" required />
          </div>
          <div class="col-sm-6">
            <textarea id="txtFPSMan2" class="form-control" rows="2" placeholder="Minimum of 25 words" required></textarea>
          </div>
        </div>
        <!-- Communication -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSCom1" class="col-sm-3 col-form-label fw-bold text-end">Communication:</label>
          <div class="col-sm-3 mb-2 mb-sm-0">
            <input type="text" id="txtFPSCom1" class="form-control" placeholder="GOOD / OKAY / POOR / N/A" required />
          </div>
          <div class="col-sm-6">
            <textarea id="txtFPSCom2" class="form-control" rows="2" placeholder="Minimum of 25 words" required></textarea>
          </div>
        </div>
        <!-- Driving ability -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSDriv1" class="col-sm-3 col-form-label fw-bold text-end">Driving ability:</label>
          <div class="col-sm-3 mb-2 mb-sm-0">
            <input type="text" id="txtFPSDriv1" class="form-control" placeholder="GOOD / OKAY / POOR / N/A" required />
          </div>
          <div class="col-sm-6">
            <textarea id="txtFPSDriv2" class="form-control" rows="2" placeholder="Minimum of 25 words" required></textarea>
          </div>
        </div>
        <!-- Roleplay ability -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSRP1" class="col-sm-3 col-form-label fw-bold text-end">Roleplay ability & OOC commands:</label>
          <div class="col-sm-3 mb-2 mb-sm-0">
            <input type="text" id="txtFPSRP1" class="form-control" placeholder="GOOD / OKAY / POOR / N/A" required />
          </div>
          <div class="col-sm-6">
            <textarea id="txtFPSRP2" class="form-control" rows="2" placeholder="Minimum of 25 words" required></textarea>
          </div>
        </div>
        <!-- Additional notes and checkboxes -->
        <div class="mb-3 row align-items-center">
          <label for="txtFPSRei" class="col-sm-3 col-form-label fw-bold text-end">Sections to reiterate?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSRei" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFPSAt" class="col-sm-3 col-form-label fw-bold text-end">Key mistakes?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSAt" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFPSSurv" class="col-sm-3 col-form-label fw-bold text-end">Cadet reminded to submit survey?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSSurv" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFPSGrad" class="col-sm-3 col-form-label fw-bold text-end">Comments in grading section?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSGrad" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFPSComp" class="col-sm-3 col-form-label fw-bold text-end">Report complete?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSComp" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFPSForm" class="col-sm-3 col-form-label fw-bold text-end">Session form submitted?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFPSForm" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyPSSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayPSReportBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayPSReportBB" class="form-control" rows="12" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
(() => {
  const form = document.getElementById('fpsForm');
  const bbcodeOutput = document.getElementById('displayPSReportBB');
  const successMsg = document.getElementById('copyPSSuccess');

  form.addEventListener('submit', function (e) {
    e.preventDefault();
    successMsg.textContent = '';

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    // Collect values
    const Date = document.getElementById('txtFPSDate').value;
    const Time = document.getElementById('txtFPSTime').value;
    const Mod2 = document.getElementById('txtFPSMod').value;
    const Timeline = document.getElementById('txtFPSLine').value;
    const Gen1 = document.getElementById('txtFPSGen1').value;
    const Gen2 = document.getElementById('txtFPSGen2').value;
    const Field1 = document.getElementById('txtFPSField1').value;
    const Field2 = document.getElementById('txtFPSField2').value;
    const Man1 = document.getElementById('txtFPSMan1').value;
    const Man2 = document.getElementById('txtFPSMan2').value;
    const Comm1 = document.getElementById('txtFPSCom1').value;
    const Comm2 = document.getElementById('txtFPSCom2').value;
    const Driv1 = document.getElementById('txtFPSDriv1').value;
    const Driv2 = document.getElementById('txtFPSDriv2').value;
    const RP1 = document.getElementById('txtFPSRP1').value;
    const RP2 = document.getElementById('txtFPSRP2').value;
    const reiterated = document.getElementById('txtFPSRei').value;
    const KeyMistakes = document.getElementById('txtFPSAt').value;
    const Survey = document.getElementById('txtFPSSurv').value;
    const Grade = document.getElementById('txtFPSGrad').value;
    const Complete = document.getElementById('txtFPSComp').value;
    const FormVal = document.getElementById('txtFPSForm').value;

    // Construct the BBCode
    const FPSReportBBCode = `[img]https://i.imgur.com/jn09MP7.png[/img]

[lspdsubtitle]1. SESSION DETAILS[/lspdsubtitle]
[divbox=white][list=none]
[b]Date:[/b] ${Date}
[b]Patrol Hours [ooc] UTC, 24h format [/ooc]:[/b] ${Time}
[/divbox]

[lspdsubtitle]2. SESSION CHECKLIST[/lspdsubtitle]
[divbox=white]
[size=85][i]Mark each box by changing [c][cb][/c] to [c][cbc][/c] if they performed the action, otherwise leave it unchanged. The cadet is [b]not[/b] required to do everything on this list. [/i][/size]
${Mod2}
[/divbox]

[lspdsubtitle]3. SESSION REPORT[/lspdsubtitle]
[divbox=white]
[size=85][i]Please provide a detailed timeline of the session below. Minimum of 100 words.[/i][/size]

[spoil]
${Timeline}
[/spoil]

[hr]
[size=85][i]Below is the grading section to determine the cadet's performance during the session. The grading is based on their capacity to perform their duties to the standard that would be expected of a Police Officer I and in adherence with the Department Manual. Minimum of 25 words [b]PER SECTION[/b].[/i][/size]
[spoil]
[b]General attitude, demeanor and confidence[/b]:  [ ${Gen1} ]
[list]
[*] ${Gen2}
[/list]
[b]Field awareness, including general police tasks and proper use of force[/b]:  [ ${Field1} ]
[list]
[*] ${Field2}
[/list]
[b]Understanding and practice of our departmental procedures and protocols:[/b]:  [ ${Man1} ]
[list]
[*] ${Man2}
[/list]
[b]Communication, with other Officers, suspects, and civilians[/b]:  [ ${Comm1} ]
[list]
[*] ${Comm2}
[/list]
[b]Overall driving ability, including regular patrol and at high rates of speed[/b]:  [ ${Driv1} ]
[list]
[*] ${Driv2}
[/list]
[ooc] [b]Understanding and ability to roleplay (/me's and /do's, allowing others to roleplay) and understanding of OOC commands (/cuff, /cpr, /drag, /stabilize)[/b]:  [ ${RP1} ] [/ooc]
[list]
[*][ooc] ${RP2} [/ooc]
[/list]

[hr]
[b]GOOD[/b] - [b][color=#008040]Police Officer I Standard[/color][/b]
[b]OKAY[/b] - [b][color=#FFA500]Minor Mistakes[/color][/b]
[b]POOR[/b] - [b][color=#FF0000]More Training Required[/color][/b]
[b]N/A[/b] - [b]Untested During the Session[/b]
[/spoil][/divbox]

[lspdsubtitle]4. ADDITIONAL NOTES[/lspdsubtitle]
[divbox=white][list=none]

[b]Any sections that would need to be reiterated?[/b]: [ ${reiterated} ] 
Specify here..

[b]Any key mistakes that need urgent attention?[/b]: [ ${KeyMistakes}]
Specify here..

[hr]

[b]Did you remind the Cadet to submit a Field Training Officer Review Survey?[/b]: [ ${Survey}]

[b]Have you filled in the comments in the grading section?[/b]: [ ${Grade}]

[b]Is your report on this session complete?[/b]: [ ${Complete}]
[b]Have you entered this session on the [url=https://forms.gle/jCRTjTn4p2t2nvBG6]Session Submission Form[/url]?[/b]: [ ${FormVal}]
[/divbox]

[lspdfooter][/lspdfooter]
`;

    bbcodeOutput.value = FPSReportBBCode.trim();
    bbcodeOutput.select();

    try {
      navigator.clipboard.writeText(FPSReportBBCode).then(() => {
        successMsg.textContent = 'Copied to clipboard!';
      }, () => {
        successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
      });
    } catch {
      successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
    }
  });
})();
</script>

          
<div id="FTS" class="container mt-3 myHideableSection" style="max-width: 900px; display: none;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Field Training Session (FTS) Report</h4>
    </div>
    <div class="card-body">
      <form id="ftsForm" autocomplete="off" novalidate>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSDate" class="col-sm-3 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-9">
            <input type="date" id="txtFTSDate" class="form-control" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSTime" class="col-sm-3 col-form-label fw-bold text-end">Time (UTC, 24h):</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSTime" class="form-control" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSMod" class="col-sm-3 col-form-label fw-bold text-end">Modules:</label>
          <div class="col-sm-9">
            <textarea id="txtFTSMod" class="form-control" rows="6" required>
[spoil]
[b]ORIENTATION[/b]
[list=none] 
[*] [cb] - [b]Cadet was instructed how to start watch[/b]
[*] [cb] - [b]Cadet was introduced to the concept of jurisdictions[/b]
[*] [cb] - [b]Cadet was taught how to use the MDC[/b]
[*] [cb] - [b]Cadet was introduced to our precincts and facilities[/b]
[*] [cb] - [b]Cadet was taught how to operate the impound lot[/b]
[*] [cb] - [b]Cadet was taught the basics of communication[/b]
[*] [cb] - [b]Cadet has set up a Personnel Record (MUST BE CONFIRMED BY THE FTO)[/b]
[/list]
[hr]
[b]BASIC POLICING[/b]
[list=none] 
[*] [cb] - [b]PRIORITY: Probable Cause & Arrest Procedure[/b]
[*] [cb] - [b]PRIORITY: Use of Force[/b]
[*] [cb] - [b]PRIORITY: Basics of Paperwork[/b]
[*] [cb] - [b]Basics of Law[/b]
[*] [cb] - [b]Advanced Communication[/b]
[*] [cb] - [b]Traffic Stops[/b]
[*] [cb] - [b]Pursuits[/b]
[*] [cb] - [b]Scenes, Management & BLS[/b]
[/list]
[hr]
[b]ADVANCED POLICING[/b]
[list=none] 
[*] [cb] - [b]Mask Enforcement[/b]
[*] [cb] - [b]Robbery Response[/b]
[*] [cb] - [b]Hostage Negotiation & Suicide Prevention[/b]
[*] [cb] - [b]Felony Stops[/b]
[*] [cb] - [b]Advanced Driving[/b]
[*] [cb] - [b]Seeking Assistance[/b]
[/list]
[/spoil]
            </textarea>
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSMan" class="col-sm-3 col-form-label fw-bold text-end">Manual Knowledge:</label>
          <div class="col-sm-9">
            <textarea id="txtFTSMan" class="form-control" rows="3" placeholder="Describe cadet's manual knowledge..." required></textarea>
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSBehave" class="col-sm-3 col-form-label fw-bold text-end">Behavior:</label>
          <div class="col-sm-9">
            <textarea id="txtFTSBehave" class="form-control" rows="3" placeholder="Describe cadet's behavior..." required></textarea>
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSComm" class="col-sm-3 col-form-label fw-bold text-end">Communications:</label>
          <div class="col-sm-9">
            <textarea id="txtFTSComm" class="form-control" rows="3" placeholder="Describe cadet's communication..." required></textarea>
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSRP" class="col-sm-3 col-form-label fw-bold text-end">Roleplay Abilities:</label>
          <div class="col-sm-9">
            <textarea id="txtFTSRP" class="form-control" rows="3" placeholder="Describe cadet's roleplay abilities..." required></textarea>
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSMat" class="col-sm-3 col-form-label fw-bold text-end">Understood Material?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSMat" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSRei" class="col-sm-3 col-form-label fw-bold text-end">Sections to Reiterate?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSRei" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSAt" class="col-sm-3 col-form-label fw-bold text-end">Key Mistakes?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSAt" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSSurv" class="col-sm-3 col-form-label fw-bold text-end">Cadet Reminded to Submit Survey?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSSurv" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSComp" class="col-sm-3 col-form-label fw-bold text-end">Report Complete?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSComp" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="mb-3 row align-items-center">
          <label for="txtFTSForm" class="col-sm-3 col-form-label fw-bold text-end">Session Form Submitted?</label>
          <div class="col-sm-9">
            <input type="text" id="txtFTSForm" class="form-control" placeholder="YES/NO" required />
          </div>
        </div>
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyFTSSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <div class="mt-4">
          <label for="displayFTSReportBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayFTSReportBB" class="form-control" rows="12" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
(() => {
  const form = document.getElementById('ftsForm');
  const bbcodeOutput = document.getElementById('displayFTSReportBB');
  const successMsg = document.getElementById('copyFTSSuccess');

  form.addEventListener('submit', function (e) {
    e.preventDefault();
    successMsg.textContent = '';

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    // Collect values
    const Date = document.getElementById('txtFTSDate').value;
    const Time = document.getElementById('txtFTSTime').value;
    const Mod = document.getElementById('txtFTSMod').value;
    const Manual = document.getElementById('txtFTSMan').value;
    const Behavior = document.getElementById('txtFTSBehave').value;
    const Communications = document.getElementById('txtFTSComm').value;
    const Roleplay = document.getElementById('txtFTSRP').value;
    const Material = document.getElementById('txtFTSMat').value;
    const reiterated = document.getElementById('txtFTSRei').value;
    const KeyMistakes = document.getElementById('txtFTSAt').value;
    const Survey = document.getElementById('txtFTSSurv').value;
    const Complete = document.getElementById('txtFTSComp').value;
    const FormVal = document.getElementById('txtFTSForm').value;

    // Construct the BBCode
    const FTSReportBBCode = `[img]https://i.imgur.com/fSstyRv.png[/img]

[lspdsubtitle]1. SESSION DETAILS[/lspdsubtitle]
[divbox=white][list=none]
[b]Date:[/b] ${Date}
[b]Patrol Hours [ooc] UTC, 24h format [/ooc]:[/b] ${Time}
[/divbox]

[lspdsubtitle]2. SESSION CHECKLIST[/lspdsubtitle]
[divbox=white]
[size=85][i]Mark each box by changing [c][cb][/c] to [c][cbc][/c] if a topic or module was covered in the session, otherwise leave it unchanged.[/i][/size]

${Mod}
[/divbox]
[lspdsubtitle]3. SESSION REPORT[/lspdsubtitle]
[divbox=white]
[size=85][i]Please answer each section with as much detail as possible. Minimum of 40 words [b]PER SECTION[/b].[/i][/size]

[spoil]
[b]MANUAL KNOWLEDGE[/b]
[list] Did the Cadet demonstrate they'd read the Manual, prior to the session?
[*] How much assistance did they require with the Manual contents?
[*] At any point during the session, did the cadet have trouble with any of the Manual contents?
[/list][b]Please describe how they did or did not demonstrate good Manual Knowledge.[/b]

${Manual}

[hr]
[b]BEHAVIOR[/b]
[list] How did the Cadet behave during the session?
[*] Did they ask their own questions, outside of what was being taught?
[*] How would you describe how they acted during your session together?
[/list][b]Please describe their behavior and personality.[/b]

${Behavior}

[hr]
[b]COMMUNICATIONS[/b]
[list] How do you feel the Cadet communicated during their session?
[*] Did the Cadet speak clearly and confidently? 
[*] Would you consider them able to remain calm and get their point across in high-stress situations?
[/list][b]Please describe their behavior and personality.[/b]

${Communications}

[hr]
[b](( ROLEPLAY ABILITIES ))[/b]
[list] Do you believe the Police Cadet is up to par with the rest of the department in terms of roleplay abilities?
[*]Have they demonstrated good and in-depth roleplay during your session?
[*]Has the Police Cadet used /me and /do in his roleplay to add more depth and immersion for you?
[/list][b]Please give a description of the Police Cadet's roleplay abilities.[/b]

${Roleplay}

[/spoil]
[/divbox]

[lspdsubtitle]4. ADDITIONAL NOTES[/lspdsubtitle]
[divbox=white][list=none]

[b]Did the Police Cadet display a good understanding of the session material?[/b]: [${Material}]

[b]Any sections that would need to be reiterated?[/b]: [${reiterated}] 
Specify here..

[b]Any key mistakes that need urgent attention?[/b]: [${KeyMistakes}]
Specify here..

[hr]

[b]Did you remind the Cadet to submit a Field Training Officer Review Survey?[/b]: [${Survey}]

[b]Is your report on this session complete?[/b]: [${Complete}]
[b]Have you entered this session on the [url=https://forms.gle/jCRTjTn4p2t2nvBG6]Session Submission Form[/url]?[/b]: [${FormVal}]
[/divbox]

[lspdfooter][/lspdfooter]`;

    bbcodeOutput.value = FTSReportBBCode.trim();
    bbcodeOutput.select();

    try {
      navigator.clipboard.writeText(FTSReportBBCode).then(() => {
        successMsg.textContent = 'Copied to clipboard!';
      }, () => {
        successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
      });
    } catch {
      successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
    }
  });
})();
</script>

<!-- ------------------------------------------------------- -->

<div id="VehPass" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Vehicle (Pass) Certification</h4>
    </div>
    <div class="card-body">
      <form id="vehiclePassForm" autocomplete="off" novalidate>
        <!-- Rank -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDRank" class="col-sm-3 col-form-label fw-bold text-end">Rank:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDRank" class="form-control" placeholder="Rank" required />
          </div>
        </div>

        <!-- Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDName" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDName" class="form-control" placeholder="Full Name" required />
          </div>
        </div>

        <!-- Vehicle -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDCertP" class="col-sm-3 col-form-label fw-bold text-end">Vehicle:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDCertP" class="form-control" placeholder="Vehicle Model" required />
          </div>
        </div>

        <!-- On Road Track -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDRoad" class="col-sm-3 col-form-label fw-bold text-end">On Road Track:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDRoad" class="form-control" placeholder="On Road Track Time" required />
          </div>
        </div>

        <!-- Off Road Track -->
        <div class="mb-4 row align-items-center">
          <label for="txtVPDOFF" class="col-sm-3 col-form-label fw-bold text-end">Off Road Track:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDOFF" class="form-control" placeholder="Off Road Track Time" required />
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyVehPassSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayVehPassBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayVehPassBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('vehiclePassForm');
    const rankInput = document.getElementById('txtVPDRank');
    const nameInput = document.getElementById('txtVPDName');
    const vehicleInput = document.getElementById('txtVPDCertP');
    const onRoadInput = document.getElementById('txtVPDRoad');
    const offRoadInput = document.getElementById('txtVPDOFF');
    const output = document.getElementById('displayVehPassBB');
    const successMsg = document.getElementById('copyVehPassSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Rank1 = rankInput.value.trim();
      const Name1 = nameInput.value.trim();
      const Vehicle = vehicleInput.value.trim();
      const OnRoad = onRoadInput.value.trim();
      const OffRoad = offRoadInput.value.trim();

      const forceTemplate = `[lspdfooter][/lspdfooter][divbox=white]
[fimg=150,150]https://i.imgur.com/UYd15I0.png[/fimg][aligntable=right,350,0,0,0,0,0][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=120][color=#009600]CERTIFICATION PASSED[/color][/size]
[size=95]Training Division[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]${Rank1} ${Name1},[/b]

Following your practical session, we have decided to [b]pass[/b] your vehicle certification. You may utilize the ${Vehicle}, operating under the allowed protocols defined by the Training Division.
[/list]

[hr][center][color=red][b]FOR INSTRUCTOR USE[/b][/color][/center]
[list=none]
[b]Track Times[/b]
[list]On Road Track: ${OnRoad}
[*]Off Road Track: ${OffRoad}
[/list]

[/list][hr][/hr][list=none]

Sincerely,
Police Detective I Mick Wegman
Trainee Instructor, Training Division
Los Santos Police Department

[/list][/divbox]
[lspdfooter][/lspdfooter]`;

      output.value = forceTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(forceTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>
<!-- ------------------------------------- -->

<div id="VehPract" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Vehicle (Practical) Certification</h4>
    </div>
    <div class="card-body">
      <form id="vehiclePractForm" autocomplete="off" novalidate>
        <!-- Rank -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPrR" class="col-sm-3 col-form-label fw-bold text-end">Rank:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPrR" class="form-control" placeholder="Rank" required />
          </div>
        </div>

        <!-- Name -->
        <div class="mb-4 row align-items-center">
          <label for="txtVPrN" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPrN" class="form-control" placeholder="Full Name" required />
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyPractSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayPractBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayPractBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('vehiclePractForm');
    const rankInput = document.getElementById('txtVPrR');
    const nameInput = document.getElementById('txtVPrN');
    const output = document.getElementById('displayPractBB');
    const successMsg = document.getElementById('copyPractSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Rank = rankInput.value.trim();
      const Name = nameInput.value.trim();

      const PrTemplate = `[lspdfooter][/lspdfooter][divbox=white]
[fimg=150,150]https://i.imgur.com/UYd15I0.png[/fimg][aligntable=right,350,0,0,0,0,0][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=120][color=#FFC300]CERTIFICATION PENDING[/color][/size]
[size=95]Training Division[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]${Rank} ${Name},[/b]

Following your application, we have decided to move your vehicle certification to [b]pending practical[/b]. You may contact an instructor to complete your training session and pass your certification. You have 7 days from this response to organise and complete your practical session. Failure to do so will result in a denial of your certification.

[/list][hr][/hr][list=none]

Sincerely,
Police Detective I Mick Wegman
Trainee Instructor, Training Division
Los Santos Police Department

[/list][/divbox]
[lspdfooter][/lspdfooter]`;

      output.value = PrTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(PrTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>
<!-- ------------------------------------- -->

<!-- Vehicle (Fail) -->
 <div id="VehFail" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Vehicle (Fail) Certification</h4>
    </div>
    <div class="card-body">
      <form id="vehicleFailForm" autocomplete="off" novalidate>
        <!-- Rank -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDRank1" class="col-sm-3 col-form-label fw-bold text-end">Rank:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDRank1" class="form-control" placeholder="Rank" required />
          </div>
        </div>

        <!-- Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDName1" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDName1" class="form-control" placeholder="Full Name" required />
          </div>
        </div>

        <!-- On Road Track -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDRoad1" class="col-sm-3 col-form-label fw-bold text-end">On Road Track:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDRoad1" class="form-control" placeholder="On Road Track Time" required />
          </div>
        </div>

        <!-- Off Road Track -->
        <div class="mb-4 row align-items-center">
          <label for="txtVPDOFF1" class="col-sm-3 col-form-label fw-bold text-end">Off Road Track:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDOFF1" class="form-control" placeholder="Off Road Track Time" required />
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyVFailSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayVFailBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayVFailBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('vehicleFailForm');
    const rankInput = document.getElementById('txtVPDRank1');
    const nameInput = document.getElementById('txtVPDName1');
    const onRoadInput = document.getElementById('txtVPDRoad1');
    const offRoadInput = document.getElementById('txtVPDOFF1');
    const output = document.getElementById('displayVFailBB');
    const successMsg = document.getElementById('copyVFailSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Rank2 = rankInput.value.trim();
      const Name2 = nameInput.value.trim();
      const OnRoad1 = onRoadInput.value.trim();
      const OffRoad1 = offRoadInput.value.trim();

      const VFailTemplate = `[lspdfooter][/lspdfooter][divbox=white]
[fimg=150,150]https://i.imgur.com/UYd15I0.png[/fimg][aligntable=right,350,0,0,0,0,0][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=120][color=#FF0000]CERTIFICATION FAILED[/color][/size]
[size=95]Training Division[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]${Rank2} ${Name2},[/b]

Following your application, we have decided to [b]fail[/b] your vehicle certification. You may re-apply again after 7 days.

[/list]
[hr]
[center][b][color=red]FOR INSTRUCTOR USE[/color][/b][/center]

[b]Track Times:[/b]
[list]On Road Track: ${OnRoad1}
[*]Off Road Track: ${OffRoad1}
[/list]
[hr][list=none]

Sincerely,
Police Detective I Mick Wegman
Trainee Instructor, Training Division
Los Santos Police Department

[/list][/divbox]
[lspdfooter][/lspdfooter]`;

      output.value = VFailTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(VFailTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------- -->

<!-- Weapon (Pass) -->
<div id="WPass" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Weapon (Pass) Certification</h4>
    </div>
    <div class="card-body">
      <form id="weaponPassForm" autocomplete="off" novalidate>
        <!-- Rank -->
        <div class="mb-3 row align-items-center">
          <label for="txtWPDRank1" class="col-sm-3 col-form-label fw-bold text-end">Rank:</label>
          <div class="col-sm-9">
            <input type="text" id="txtWPDRank1" class="form-control" placeholder="Rank" required />
          </div>
        </div>

        <!-- Name -->
        <div class="mb-3 row align-items-center">
          <label for="txtWPDName1" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtWPDName1" class="form-control" placeholder="Full Name" required />
          </div>
        </div>

        <!-- Weapon -->
        <div class="mb-4 row align-items-center">
          <label for="txtWPD" class="col-sm-3 col-form-label fw-bold text-end">Weapon:</label>
          <div class="col-sm-9">
            <input type="text" id="txtWPD" class="form-control" placeholder="Weapon Model" required />
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyWPassSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayWPassBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayWPassBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('weaponPassForm');
    const rankInput = document.getElementById('txtWPDRank1');
    const nameInput = document.getElementById('txtWPDName1');
    const weaponInput = document.getElementById('txtWPD');
    const output = document.getElementById('displayWPassBB');
    const successMsg = document.getElementById('copyWPassSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Rank3 = rankInput.value.trim();
      const Name3 = nameInput.value.trim();
      const Weapon = weaponInput.value.trim();

      const WPassTemplate = `[lspdfooter][/lspdfooter][divbox=white]
[fimg=150,150]https://i.imgur.com/UYd15I0.png[/fimg][aligntable=right,350,0,0,0,0,0][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=120][color=#009600]CERTIFICATION PASSED[/color][/size]
[size=95]Training Division[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]${Rank3} ${Name3},[/b]

Following your application, we have decided to [b]pass[/b] your weapon certification. You may utilize the ${Weapon}, operating under the allowed protocols defined by the Training Division.

[/list][hr][/hr][list=none]

Sincerely,
Police Detective I Mick Wegman
Trainee Instructor, Training Division
Los Santos Police Department

[/list][/divbox]
[lspdfooter][/lspdfooter]`;

      output.value = WPassTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(WPassTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>
<!-- ------------------------------------- -->

<!-- Weapon (Fail) -->
<div id="WFail" class="container mt-3 myHideableSection" style="max-width: 700px;">
        <div class="card shadow" style="background: linear-gradient(135deg, #001f4d, #003399); color: #fff;">
    <div class="card-header text-center">
      <h4>Weapon (Fail) Certification</h4>
    </div>
    <div class="card-body">
      <form id="weaponFailForm" autocomplete="off" novalidate>
        <!-- Rank -->
        <div class="mb-3 row align-items-center">
          <label for="txtVPDRank2" class="col-sm-3 col-form-label fw-bold text-end">Rank:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDRank2" class="form-control" placeholder="Rank" required />
          </div>
        </div>

        <!-- Name -->
        <div class="mb-4 row align-items-center">
          <label for="txtVPDName2" class="col-sm-3 col-form-label fw-bold text-end">Name:</label>
          <div class="col-sm-9">
            <input type="text" id="txtVPDName2" class="form-control" placeholder="Full Name" required />
          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Submit and Copy to Clipboard</button>
          <p id="copyWFailSuccess" class="mt-2 text-success fw-semibold"></p>
        </div>

        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="displayWFailBB" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="displayWFailBB" class="form-control" rows="10" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  (() => {
    const form = document.getElementById('weaponFailForm');
    const rankInput = document.getElementById('txtVPDRank2');
    const nameInput = document.getElementById('txtVPDName2');
    const output = document.getElementById('displayWFailBB');
    const successMsg = document.getElementById('copyWFailSuccess');

    form.addEventListener('submit', e => {
      e.preventDefault();
      successMsg.textContent = '';

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const Rank5 = rankInput.value.trim();
      const Name5 = nameInput.value.trim();

      const WFailTemplate = `[lspdfooter][/lspdfooter][divbox=white]
[fimg=150,150]https://i.imgur.com/UYd15I0.png[/fimg][aligntable=right,350,0,0,0,0,0][right][font=Arial][b]
[size=150]Los Santos Police Department[/size][/b]
[size=120][color=#FF0000]CERTIFICATION FAILED[/color][/size]
[size=95]Training Division[/size][/font][/right][/aligntable]
[hr]
[list=none]
[b]${Rank5} ${Name5},[/b]

Following your application, we have decided to [b]fail[/b] your weapon certification. You may re-apply again after 7 days.

[/list][hr][/hr][list=none]

Sincerely,
Police Detective I Mick Wegman
Trainee Instructor, Training Division
Los Santos Police Department

[/list][/divbox]
[lspdfooter][/lspdfooter]`;

      output.value = WFailTemplate.trim();
      output.select();

      try {
        navigator.clipboard.writeText(WFailTemplate).then(() => {
          successMsg.textContent = 'Copied to clipboard!';
        }, () => {
          successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
        });
      } catch {
        successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
      }
    });
  })();
</script>

<!-- ------------------------------------------------------- -->


    <!-- END GENERATED FORMS AND LOGIC -->
  </main>

  <!-- Scripts for Sidebar Accordion, Section Switching, and All Form Generators -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Show and remember the active section
  function showSection(id, btn) {
    // Remove highlight from all sidebar buttons
    document.querySelectorAll('.sidebar .btn').forEach(el => el.classList.remove('btn-success'));
    if (btn) btn.classList.add('btn-success');
    // Hide all content sections
    document.querySelectorAll('.main-content .myHideableSection').forEach(s => s.classList.remove('active'));
    // Show the selected section
    let match = document.getElementById(id);
    if (match) {
      match.classList.add('active');
      match.scrollIntoView({ behavior: 'smooth', block: 'start' });
      // Persist last opened section ID
      localStorage.setItem('lastSection', id);
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    // Try to load the last opened section from localStorage
    const lastSectionId = localStorage.getItem('lastSection');
    // Verify the ID is still in the DOM
    let targetId = lastSectionId;
    if (!targetId || !document.getElementById(targetId)) {
      targetId = document.querySelector('.myHideableSection')?.id;
    }
    if (targetId) showSection(targetId, null);
  });
</script>


  <!-- Paste all per-form scripts from your original file below -->
  <!-- These scripts handle dynamic lists, BBCode generation/copy, and interactivity for each section. Keep them in exact order. -->
  <!--
    <script> ... (script blocks for each generator, as in your file) ... </script>
    ...
  -->
</body>
</html>
